// Decompiled with JetBrains decompiler
// Type: frmScannerSearchCol
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using DataBase;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using My;
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.Runtime.CompilerServices;
using System.Text;
using System.Windows.Forms;

[DesignerGenerated]
public class frmScannerSearchCol : Form
{
  private IContainer components;
  [AccessedThroughProperty("lvwData")]
  private ListViewExt _lvwData;
  [AccessedThroughProperty("ColumnHeader5")]
  private ColumnHeader _ColumnHeader5;
  [AccessedThroughProperty("ColumnHeader6")]
  private ColumnHeader _ColumnHeader6;
  [AccessedThroughProperty("stsMain")]
  private StatusStrip _stsMain;
  [AccessedThroughProperty("lblStatus")]
  private ToolStripStatusLabel _lblStatus;
  [AccessedThroughProperty("mnuListview")]
  private ContextMenuStrip _mnuListview;
  [AccessedThroughProperty("mnuShell")]
  private ToolStripMenuItem _mnuShell;
  [AccessedThroughProperty("mnuClipboard")]
  private ToolStripMenuItem _mnuClipboard;
  [AccessedThroughProperty("ColumnHeader1")]
  private ColumnHeader _ColumnHeader1;
  [AccessedThroughProperty("ColumnHeader2")]
  private ColumnHeader _ColumnHeader2;
  [AccessedThroughProperty("mnuDumper")]
  private ContextMenuStrip _mnuDumper;
  [AccessedThroughProperty("mnuDumper1")]
  private ToolStripMenuItem _mnuDumper1;
  [AccessedThroughProperty("mnuDumper2")]
  private ToolStripMenuItem _mnuDumper2;
  [AccessedThroughProperty("btnGoToDumper")]
  private ToolStripDropDownButton _btnGoToDumper;
  [AccessedThroughProperty("btnCopy")]
  private ToolStripButton _btnCopy;
  [AccessedThroughProperty("ToolStripSeparator1")]
  private ToolStripSeparator _ToolStripSeparator1;
  [AccessedThroughProperty("btnSort")]
  private ToolStripButton _btnSort;
  [AccessedThroughProperty("ToolStripSeparator2")]
  private ToolStripSeparator _ToolStripSeparator2;
  [AccessedThroughProperty("cmbMinRows")]
  private ToolStripComboBox _cmbMinRows;
  [AccessedThroughProperty("tsChecker2")]
  private ToolStrip _tsChecker2;
  [AccessedThroughProperty("ToolStripLabel1")]
  private ToolStripLabel _ToolStripLabel1;
  [AccessedThroughProperty("cmbSearch")]
  private ToolStripComboBox _cmbSearch;
  [AccessedThroughProperty("mnuFocusItem")]
  private ToolStripMenuItem _mnuFocusItem;
  private int __Count;
  private frmScannerSearchCol.Engine __Engine;
  private UrlListView __UrlList;
  private bool GUI;

  [DebuggerNonUserCode]
  protected override void Dispose(bool disposing)
  {
    try
    {
      if (!disposing || this.components == null)
        return;
      this.components.Dispose();
    }
    finally
    {
      base.Dispose(disposing);
    }
  }

  [DebuggerStepThrough]
  private void InitializeComponent()
  {
    this.components = (IContainer) new System.ComponentModel.Container();
    ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof (frmScannerSearchCol));
    this.stsMain = new StatusStrip();
    this.lblStatus = new ToolStripStatusLabel();
    this.mnuDumper = new ContextMenuStrip(this.components);
    this.mnuDumper2 = new ToolStripMenuItem();
    this.mnuDumper1 = new ToolStripMenuItem();
    this.btnGoToDumper = new ToolStripDropDownButton();
    this.mnuListview = new ContextMenuStrip(this.components);
    this.mnuShell = new ToolStripMenuItem();
    this.mnuClipboard = new ToolStripMenuItem();
    this.mnuFocusItem = new ToolStripMenuItem();
    this.ColumnHeader5 = new ColumnHeader();
    this.ColumnHeader6 = new ColumnHeader();
    this.btnCopy = new ToolStripButton();
    this.ToolStripSeparator1 = new ToolStripSeparator();
    this.btnSort = new ToolStripButton();
    this.ToolStripSeparator2 = new ToolStripSeparator();
    this.cmbMinRows = new ToolStripComboBox();
    this.tsChecker2 = new ToolStrip();
    this.ToolStripLabel1 = new ToolStripLabel();
    this.cmbSearch = new ToolStripComboBox();
    this.lvwData = new ListViewExt();
    this.ColumnHeader1 = new ColumnHeader();
    this.ColumnHeader2 = new ColumnHeader();
    this.stsMain.SuspendLayout();
    this.mnuDumper.SuspendLayout();
    this.mnuListview.SuspendLayout();
    this.tsChecker2.SuspendLayout();
    this.SuspendLayout();
    this.stsMain.Items.AddRange(new ToolStripItem[1]
    {
      (ToolStripItem) this.lblStatus
    });
    StatusStrip stsMain1 = this.stsMain;
    Point point1 = new Point(0, 523);
    Point point2 = point1;
    stsMain1.Location = point2;
    this.stsMain.Name = "stsMain";
    this.stsMain.RenderMode = ToolStripRenderMode.Professional;
    StatusStrip stsMain2 = this.stsMain;
    Size size1 = new Size(513, 22);
    Size size2 = size1;
    stsMain2.Size = size2;
    this.stsMain.TabIndex = 3;
    this.stsMain.Text = "StatusStrip1";
    this.lblStatus.Name = "lblStatus";
    ToolStripStatusLabel lblStatus = this.lblStatus;
    size1 = new Size(498, 17);
    Size size3 = size1;
    lblStatus.Size = size3;
    this.lblStatus.Spring = true;
    this.lblStatus.TextAlign = ContentAlignment.MiddleLeft;
    this.mnuDumper.Items.AddRange(new ToolStripItem[2]
    {
      (ToolStripItem) this.mnuDumper2,
      (ToolStripItem) this.mnuDumper1
    });
    this.mnuDumper.Name = "mnuListView";
    this.mnuDumper.OwnerItem = (ToolStripItem) this.btnGoToDumper;
    this.mnuDumper.ShowImageMargin = false;
    ContextMenuStrip mnuDumper = this.mnuDumper;
    size1 = new Size(167, 48);
    Size size4 = size1;
    mnuDumper.Size = size4;
    this.mnuDumper2.Name = "mnuDumper2";
    ToolStripMenuItem mnuDumper2 = this.mnuDumper2;
    size1 = new Size(166, 22);
    Size size5 = size1;
    mnuDumper2.Size = size5;
    this.mnuDumper2.Text = "New Dumper Instance";
    this.mnuDumper1.Name = "mnuDumper1";
    ToolStripMenuItem mnuDumper1 = this.mnuDumper1;
    size1 = new Size(166, 22);
    Size size6 = size1;
    mnuDumper1.Size = size6;
    this.mnuDumper1.Text = "Dumper Form";
    this.btnGoToDumper.DropDown = (ToolStripDropDown) this.mnuDumper;
    this.btnGoToDumper.Enabled = false;
    this.btnGoToDumper.Image = (Image) My.Resources.Resources.Retry;
    this.btnGoToDumper.ImageTransparentColor = Color.Magenta;
    this.btnGoToDumper.Name = "btnGoToDumper";
    ToolStripDropDownButton btnGoToDumper = this.btnGoToDumper;
    size1 = new Size(114, 22);
    Size size7 = size1;
    btnGoToDumper.Size = size7;
    this.btnGoToDumper.Text = "&Go To Dumper";
    this.mnuListview.Items.AddRange(new ToolStripItem[3]
    {
      (ToolStripItem) this.mnuShell,
      (ToolStripItem) this.mnuClipboard,
      (ToolStripItem) this.mnuFocusItem
    });
    this.mnuListview.Name = "mnuListView";
    this.mnuListview.ShowImageMargin = false;
    ContextMenuStrip mnuListview = this.mnuListview;
    size1 = new Size(133, 70);
    Size size8 = size1;
    mnuListview.Size = size8;
    this.mnuShell.Name = "mnuShell";
    ToolStripMenuItem mnuShell = this.mnuShell;
    size1 = new Size(132, 22);
    Size size9 = size1;
    mnuShell.Size = size9;
    this.mnuShell.Text = "Shell URL";
    this.mnuClipboard.Name = "mnuClipboard";
    ToolStripMenuItem mnuClipboard = this.mnuClipboard;
    size1 = new Size(132, 22);
    Size size10 = size1;
    mnuClipboard.Size = size10;
    this.mnuClipboard.Text = "Clipboard URL";
    this.mnuFocusItem.Name = "mnuFocusItem";
    ToolStripMenuItem mnuFocusItem = this.mnuFocusItem;
    size1 = new Size(132, 22);
    Size size11 = size1;
    mnuFocusItem.Size = size11;
    this.mnuFocusItem.Text = "Focus Grid Item";
    this.ColumnHeader5.Text = "Description";
    this.ColumnHeader5.Width = 89;
    this.ColumnHeader6.Text = "Value";
    this.ColumnHeader6.Width = 342;
    this.btnCopy.Image = (Image) componentResourceManager.GetObject("btnCopy.Image");
    this.btnCopy.ImageTransparentColor = Color.Magenta;
    this.btnCopy.Name = "btnCopy";
    ToolStripButton btnCopy = this.btnCopy;
    size1 = new Size(79, 22);
    Size size12 = size1;
    btnCopy.Size = size12;
    this.btnCopy.Text = "&Clipboard";
    this.ToolStripSeparator1.Name = "ToolStripSeparator1";
    ToolStripSeparator toolStripSeparator1 = this.ToolStripSeparator1;
    size1 = new Size(6, 25);
    Size size13 = size1;
    toolStripSeparator1.Size = size13;
    this.btnSort.Alignment = ToolStripItemAlignment.Right;
    this.btnSort.Image = (Image) My.Resources.Resources.CheckSpellingHS;
    this.btnSort.ImageTransparentColor = Color.Magenta;
    this.btnSort.Name = "btnSort";
    ToolStripButton btnSort = this.btnSort;
    size1 = new Size(43, 22);
    Size size14 = size1;
    btnSort.Size = size14;
    this.btnSort.Text = "&OK";
    this.ToolStripSeparator2.Alignment = ToolStripItemAlignment.Right;
    this.ToolStripSeparator2.Name = "ToolStripSeparator2";
    ToolStripSeparator toolStripSeparator2 = this.ToolStripSeparator2;
    size1 = new Size(6, 25);
    Size size15 = size1;
    toolStripSeparator2.Size = size15;
    this.cmbMinRows.Alignment = ToolStripItemAlignment.Right;
    this.cmbMinRows.DropDownStyle = ComboBoxStyle.DropDownList;
    this.cmbMinRows.Name = "cmbMinRows";
    ToolStripComboBox cmbMinRows = this.cmbMinRows;
    size1 = new Size(75, 25);
    Size size16 = size1;
    cmbMinRows.Size = size16;
    this.tsChecker2.GripStyle = ToolStripGripStyle.Hidden;
    this.tsChecker2.Items.AddRange(new ToolStripItem[8]
    {
      (ToolStripItem) this.btnCopy,
      (ToolStripItem) this.ToolStripSeparator1,
      (ToolStripItem) this.btnGoToDumper,
      (ToolStripItem) this.btnSort,
      (ToolStripItem) this.ToolStripSeparator2,
      (ToolStripItem) this.cmbMinRows,
      (ToolStripItem) this.ToolStripLabel1,
      (ToolStripItem) this.cmbSearch
    });
    ToolStrip tsChecker2_1 = this.tsChecker2;
    point1 = new Point(0, 0);
    Point point3 = point1;
    tsChecker2_1.Location = point3;
    this.tsChecker2.Name = "tsChecker2";
    this.tsChecker2.RenderMode = ToolStripRenderMode.Professional;
    ToolStrip tsChecker2_2 = this.tsChecker2;
    size1 = new Size(513, 25);
    Size size17 = size1;
    tsChecker2_2.Size = size17;
    this.tsChecker2.TabIndex = 4;
    this.tsChecker2.Text = "ToolStrip1";
    this.ToolStripLabel1.Alignment = ToolStripItemAlignment.Right;
    this.ToolStripLabel1.Name = "ToolStripLabel1";
    ToolStripLabel toolStripLabel1 = this.ToolStripLabel1;
    size1 = new Size(68, 22);
    Size size18 = size1;
    toolStripLabel1.Size = size18;
    this.ToolStripLabel1.Text = "Min.. Rows:";
    this.cmbSearch.Alignment = ToolStripItemAlignment.Right;
    this.cmbSearch.DropDownStyle = ComboBoxStyle.DropDownList;
    this.cmbSearch.Name = "cmbSearch";
    ToolStripComboBox cmbSearch = this.cmbSearch;
    size1 = new Size(75, 25);
    Size size19 = size1;
    cmbSearch.Size = size19;
    this.lvwData.AccessibleDescription = "";
    this.lvwData.AccessibleName = "";
    this.lvwData.Columns.AddRange(new ColumnHeader[2]
    {
      this.ColumnHeader1,
      this.ColumnHeader2
    });
    this.lvwData.ContextMenuStrip = this.mnuListview;
    this.lvwData.Dock = DockStyle.Fill;
    this.lvwData.ForeColor = SystemColors.ControlText;
    this.lvwData.FullRowSelect = true;
    this.lvwData.HeaderStyle = ColumnHeaderStyle.Nonclickable;
    this.lvwData.HideSelection = false;
    ListViewExt lvwData1 = this.lvwData;
    point1 = new Point(0, 25);
    Point point4 = point1;
    lvwData1.Location = point4;
    this.lvwData.Name = "lvwData";
    ListViewExt lvwData2 = this.lvwData;
    size1 = new Size(513, 498);
    Size size20 = size1;
    lvwData2.Size = size20;
    this.lvwData.TabIndex = 2;
    this.lvwData.UseCompatibleStateImageBehavior = false;
    this.lvwData.View = View.Details;
    this.ColumnHeader1.Text = "";
    this.ColumnHeader1.Width = 84;
    this.ColumnHeader2.Text = "";
    this.ColumnHeader2.Width = 336;
    this.AutoScaleDimensions = new SizeF(6f, 13f);
    this.AutoScaleMode = AutoScaleMode.Font;
    size1 = new Size(513, 545);
    this.ClientSize = size1;
    this.Controls.Add((Control) this.lvwData);
    this.Controls.Add((Control) this.tsChecker2);
    this.Controls.Add((Control) this.stsMain);
    this.FormBorderStyle = FormBorderStyle.SizableToolWindow;
    this.Name = nameof (frmScannerSearchCol);
    this.ShowIcon = false;
    this.ShowInTaskbar = false;
    this.StartPosition = FormStartPosition.Manual;
    this.Text = "Search Column";
    this.stsMain.ResumeLayout(false);
    this.stsMain.PerformLayout();
    this.mnuDumper.ResumeLayout(false);
    this.mnuListview.ResumeLayout(false);
    this.tsChecker2.ResumeLayout(false);
    this.tsChecker2.PerformLayout();
    this.ResumeLayout(false);
    this.PerformLayout();
  }

  internal virtual ListViewExt lvwData
  {
    get => this._lvwData;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.lvwHash_SelectedIndexChanged);
      if (this._lvwData != null)
        this._lvwData.SelectedIndexChanged -= eventHandler;
      this._lvwData = value;
      if (this._lvwData == null)
        return;
      this._lvwData.SelectedIndexChanged += eventHandler;
    }
  }

  internal virtual ColumnHeader ColumnHeader5
  {
    get => this._ColumnHeader5;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ColumnHeader5 = value;
  }

  internal virtual ColumnHeader ColumnHeader6
  {
    get => this._ColumnHeader6;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ColumnHeader6 = value;
  }

  public virtual StatusStrip stsMain
  {
    get => this._stsMain;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._stsMain = value;
  }

  public virtual ToolStripStatusLabel lblStatus
  {
    get => this._lblStatus;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._lblStatus = value;
  }

  internal virtual ContextMenuStrip mnuListview
  {
    get => this._mnuListview;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      CancelEventHandler cancelEventHandler = new CancelEventHandler(this.mnuListview_Opening);
      if (this._mnuListview != null)
        this._mnuListview.Opening -= cancelEventHandler;
      this._mnuListview = value;
      if (this._mnuListview == null)
        return;
      this._mnuListview.Opening += cancelEventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuShell
  {
    get => this._mnuShell;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mnuShell_Click);
      if (this._mnuShell != null)
        this._mnuShell.Click -= eventHandler;
      this._mnuShell = value;
      if (this._mnuShell == null)
        return;
      this._mnuShell.Click += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuClipboard
  {
    get => this._mnuClipboard;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mnuShell_Click);
      if (this._mnuClipboard != null)
        this._mnuClipboard.Click -= eventHandler;
      this._mnuClipboard = value;
      if (this._mnuClipboard == null)
        return;
      this._mnuClipboard.Click += eventHandler;
    }
  }

  internal virtual ColumnHeader ColumnHeader1
  {
    get => this._ColumnHeader1;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ColumnHeader1 = value;
  }

  internal virtual ColumnHeader ColumnHeader2
  {
    get => this._ColumnHeader2;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ColumnHeader2 = value;
  }

  internal virtual ContextMenuStrip mnuDumper
  {
    get => this._mnuDumper;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._mnuDumper = value;
  }

  internal virtual ToolStripMenuItem mnuDumper1
  {
    get => this._mnuDumper1;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.btnGoToDumper_Click);
      if (this._mnuDumper1 != null)
        this._mnuDumper1.Click -= eventHandler;
      this._mnuDumper1 = value;
      if (this._mnuDumper1 == null)
        return;
      this._mnuDumper1.Click += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuDumper2
  {
    get => this._mnuDumper2;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.btnGoToDumper_Click);
      if (this._mnuDumper2 != null)
        this._mnuDumper2.Click -= eventHandler;
      this._mnuDumper2 = value;
      if (this._mnuDumper2 == null)
        return;
      this._mnuDumper2.Click += eventHandler;
    }
  }

  internal virtual ToolStripDropDownButton btnGoToDumper
  {
    get => this._btnGoToDumper;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._btnGoToDumper = value;
  }

  internal virtual ToolStripButton btnCopy
  {
    get => this._btnCopy;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.btnCopy_Click);
      if (this._btnCopy != null)
        this._btnCopy.Click -= eventHandler;
      this._btnCopy = value;
      if (this._btnCopy == null)
        return;
      this._btnCopy.Click += eventHandler;
    }
  }

  internal virtual ToolStripSeparator ToolStripSeparator1
  {
    get => this._ToolStripSeparator1;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ToolStripSeparator1 = value;
  }

  internal virtual ToolStripButton btnSort
  {
    get => this._btnSort;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.btnSort_Click);
      if (this._btnSort != null)
        this._btnSort.Click -= eventHandler;
      this._btnSort = value;
      if (this._btnSort == null)
        return;
      this._btnSort.Click += eventHandler;
    }
  }

  internal virtual ToolStripSeparator ToolStripSeparator2
  {
    get => this._ToolStripSeparator2;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ToolStripSeparator2 = value;
  }

  internal virtual ToolStripComboBox cmbMinRows
  {
    get => this._cmbMinRows;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.cmbs_SelectedIndexChanged);
      if (this._cmbMinRows != null)
        this._cmbMinRows.SelectedIndexChanged -= eventHandler;
      this._cmbMinRows = value;
      if (this._cmbMinRows == null)
        return;
      this._cmbMinRows.SelectedIndexChanged += eventHandler;
    }
  }

  public virtual ToolStrip tsChecker2
  {
    get => this._tsChecker2;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._tsChecker2 = value;
  }

  internal virtual ToolStripLabel ToolStripLabel1
  {
    get => this._ToolStripLabel1;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ToolStripLabel1 = value;
  }

  internal virtual ToolStripComboBox cmbSearch
  {
    get => this._cmbSearch;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.cmbs_SelectedIndexChanged);
      if (this._cmbSearch != null)
        this._cmbSearch.SelectedIndexChanged -= eventHandler;
      this._cmbSearch = value;
      if (this._cmbSearch == null)
        return;
      this._cmbSearch.SelectedIndexChanged += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuFocusItem
  {
    get => this._mnuFocusItem;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mnuFocusItem_Click);
      if (this._mnuFocusItem != null)
        this._mnuFocusItem.Click -= eventHandler;
      this._mnuFocusItem = value;
      if (this._mnuFocusItem == null)
        return;
      this._mnuFocusItem.Click += eventHandler;
    }
  }

  private void UpdateCount()
  {
    if (this.InvokeRequired)
      this.Invoke((Delegate) ((sender, e) => this.UpdateCount()));
    else
      this.lblStatus.Text = "Total Rows: " + Strings.FormatNumber((object) this.__Count, 0);
  }

  [MethodImpl(MethodImplOptions.NoOptimization)]
  internal void Add(
    string sURL,
    string sMethod,
    string sSearch,
    int iCount,
    List<string> lTables)
  {
    try
    {
      this.__Engine.Add(sURL, sMethod, sSearch, iCount, lTables);
      checked { this.__Count += iCount; }
      this.UpdateCount();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, MyProject.Application.Info.Title, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  [MethodImpl(MethodImplOptions.NoOptimization)]
  private void btnCopy_Click(object sender, EventArgs e)
  {
    try
    {
      StringBuilder stringBuilder = new StringBuilder();
      try
      {
        foreach (ListViewGroup group in this.lvwData.Groups)
        {
          stringBuilder.AppendLine(group.Header);
          try
          {
            foreach (ListViewItem listViewItem in group.Items)
            {
              if (!string.IsNullOrEmpty(listViewItem.Text))
                stringBuilder.AppendLine(listViewItem.Text + ":" + listViewItem.SubItems[1].Text);
              else
                stringBuilder.AppendLine(listViewItem.SubItems[1].Text);
            }
          }
          finally
          {
            IEnumerator enumerator;
            if (enumerator is IDisposable)
              (enumerator as IDisposable).Dispose();
          }
          stringBuilder.AppendLine();
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      if (string.IsNullOrEmpty(stringBuilder.ToString()))
        return;
      Clipboard.SetText(stringBuilder.ToString());
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, MyProject.Application.Info.Title, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  private void lvwHash_SelectedIndexChanged(object sender, EventArgs e) => this.btnGoToDumper.Enabled = this.lvwData.SelectedItems.Count == 1;

  private void btnGoToDumper_Click(object sender, EventArgs e)
  {
    try
    {
      string sURL = "";
      string str1 = "";
      List<string> lTables = new List<string>();
      this.btnGoToDumper.Enabled = false;
      try
      {
        foreach (ListViewItem listViewItem in this.lvwData.SelectedItems[0].Group.Items)
        {
          string text = listViewItem.Text;
          if (Operators.CompareString(text, "URL", false) == 0)
            sURL = listViewItem.SubItems[1].Text;
          else if (Operators.CompareString(text, "Method", false) == 0)
            str1 = listViewItem.SubItems[1].Text;
          else if (Operators.CompareString(text, "", false) == 0)
            lTables.Add(listViewItem.SubItems[1].Text);
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      if (sender == this.mnuDumper2)
      {
        Globals.G_Main.OpenNewMiniDumper(sURL, str1, lTables);
      }
      else
      {
        if (Globals.G_Dumper.RunningWorker)
          return;
        int num;
        switch (Utls.StringToType(str1))
        {
          case Types.MySQL_No_Error:
            num = 0;
            break;
          case Types.MySQL_With_Error:
            num = 1;
            break;
          case Types.MSSQL_No_Error:
            num = 2;
            break;
          case Types.MSSQL_With_Error:
            num = 3;
            break;
          case Types.Oracle_No_Error:
            num = 4;
            break;
          case Types.Oracle_With_Error:
            num = 5;
            break;
          case Types.PostgreSQL_No_Error:
            num = 6;
            break;
          case Types.PostgreSQL_With_Error:
            num = 7;
            break;
        }
        Globals.G_Dumper.txtURL.Text = sURL;
        Globals.G_Dumper.cmbSqlType.SelectedIndex = num;
        Globals.G_Main.mdiTabControl.SelectItem(Globals.G_Main.mdiTabControl.TabPages[(Form) Globals.G_Dumper]);
        Globals.G_Dumper.chkClearListOnGet.Checked = true;
        Globals.G_Dumper.btnServerInfo_Click((object) null, (EventArgs) null);
        while (Globals.G_Dumper.RunningWorker)
          Application.DoEvents();
        try
        {
          foreach (string str2 in lTables)
          {
            string[] strArray = Strings.Split(str2.Substring(str2.LastIndexOf(" ")).Trim(), ".");
            if (strArray.Length > 1)
            {
              Globals.G_Dumper.AddDataBase(strArray[0]);
              Globals.G_Dumper.AddTable(strArray[0], strArray[1]);
            }
          }
        }
        finally
        {
          List<string>.Enumerator enumerator;
          enumerator.Dispose();
        }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
    finally
    {
      this.btnGoToDumper.Enabled = true;
    }
  }

  private void mnuListview_Opening(object sender, CancelEventArgs e) => e.Cancel = this.lvwData.SelectedItems.Count == 0;

  private void mnuShell_Click(object sender, EventArgs e)
  {
    try
    {
      string str = "";
      try
      {
        foreach (ListViewItem listViewItem in this.lvwData.SelectedItems[0].Group.Items)
        {
          if (Operators.CompareString(listViewItem.Text, "URL", false) == 0)
            str = listViewItem.SubItems[1].Text;
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      if (string.IsNullOrEmpty(str))
        return;
      if (sender == this.mnuShell)
        Globals.ShellURL(str.Replace("[t]", "99"));
      else
        Clipboard.SetText(str.Replace("[t]", "99"));
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  internal void btnSort_Click(object sender, EventArgs e)
  {
    try
    {
      if (!this.GUI)
        return;
      if (!this.__Engine.AddItems && this.cmbSearch.Items.Count == 1)
        this.cmbSearch.Items.AddRange((object[]) this.__Engine.Search.ToArray());
      List<ListViewGroup> oGroups = (List<ListViewGroup>) null;
      List<ListViewItem> oItems = (List<ListViewItem>) null;
      string sSearch = this.cmbSearch.SelectedIndex != 0 ? Conversions.ToString(this.cmbSearch.SelectedItem) : "";
      this.__Engine.GetItems(ref oItems, ref oGroups, sSearch);
      this.RefreshGUI(oItems, oGroups);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  private void frmScannerSearchCol_Load(object sender, EventArgs e)
  {
    this.cmbMinRows.Items.AddRange((object[]) new string[7]
    {
      "1k",
      "5k",
      "10k",
      "30k",
      "50k",
      "100k",
      "All"
    });
    this.cmbMinRows.SelectedIndex = checked (this.cmbMinRows.Items.Count - 1);
    this.lvwData.ShowGroups = true;
    this.GUI = true;
  }

  private void cmbs_SelectedIndexChanged(object sender, EventArgs e)
  {
    try
    {
      switch (this.cmbMinRows.SelectedIndex)
      {
        case 0:
          this.__Engine.MiniRows = 1000;
          break;
        case 1:
          this.__Engine.MiniRows = 5000;
          break;
        case 2:
          this.__Engine.MiniRows = 10000;
          break;
        case 3:
          this.__Engine.MiniRows = 30000;
          break;
        case 4:
          this.__Engine.MiniRows = 50000;
          break;
        case 5:
          this.__Engine.MiniRows = 100000;
          break;
        case 6:
          this.__Engine.MiniRows = 0;
          break;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  private void RefreshGUI(List<ListViewItem> oItems, List<ListViewGroup> oGroup)
  {
    if (this.InvokeRequired)
    {
      this.Invoke((Delegate) new frmScannerSearchCol.DRefreshGUI(this.RefreshGUI), (object) oItems, (object) oGroup);
    }
    else
    {
      Globals.LockWindowUpdate(this.lvwData.Handle);
      this.lvwData.Groups.Clear();
      this.lvwData.Items.Clear();
      this.lvwData.Items.AddRange(oItems.ToArray());
      this.lvwData.Groups.AddRange(oGroup.ToArray());
      Globals.LockWindowUpdate(IntPtr.Zero);
    }
  }

  public frmScannerSearchCol(bool bExploiter, UrlListView url)
  {
    this.Load += new EventHandler(this.frmScannerSearchCol_Load);
    this.InitializeComponent();
    this.lvwData.ShowGroups = true;
    this.lvwData.ShowItemToolTips = true;
    this.cmbSearch.Items.Add((object) "All");
    this.cmbSearch.SelectedIndex = 0;
    this.__UrlList = url;
    this.__Engine = new frmScannerSearchCol.Engine(bExploiter, this.lvwData, this.cmbSearch);
  }

  private void mnuFocusItem_Click(object sender, EventArgs e)
  {
    try
    {
      string url = "";
      try
      {
        foreach (ListViewItem listViewItem in this.lvwData.SelectedItems[0].Group.Items)
        {
          if (Operators.CompareString(listViewItem.Text, "URL", false) == 0)
            url = listViewItem.SubItems[1].Text;
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      if (string.IsNullOrEmpty(url))
        return;
      this.__UrlList.FocusItem(url);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  public class Engine
  {
    public List<string> Search;
    private Dictionary<string, frmScannerSearchCol.Engine.Macth> Dict;
    private ListViewExt LVW;
    private ToolStripComboBox LST;

    public int MiniRows { get; set; }

    public bool AddItems { get; set; }

    public void GetItems(
      ref List<ListViewItem> oItems,
      ref List<ListViewGroup> oGroups,
      string sSearch)
    {
      oItems = new List<ListViewItem>();
      oGroups = new List<ListViewGroup>();
      Dictionary<string, frmScannerSearchCol.Engine.Macth> o = new Dictionary<string, frmScannerSearchCol.Engine.Macth>();
      try
      {
        foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Macth> keyValuePair in this.Dict)
        {
          try
          {
            foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Traget> detalhe in keyValuePair.Value.Detalhes)
            {
              if ((string.IsNullOrEmpty(sSearch) || detalhe.Value.Search.Equals(sSearch)) && detalhe.Value.Rows >= this.MiniRows)
              {
                o.Add(keyValuePair.Key, keyValuePair.Value);
                if (!string.IsNullOrEmpty(sSearch))
                {
                  keyValuePair.Value.TotalRows = detalhe.Value.Rows;
                  break;
                }
                break;
              }
            }
          }
          finally
          {
            Dictionary<string, frmScannerSearchCol.Engine.Traget>.Enumerator enumerator;
            enumerator.Dispose();
          }
        }
      }
      finally
      {
        Dictionary<string, frmScannerSearchCol.Engine.Macth>.Enumerator enumerator;
        enumerator.Dispose();
      }
      Dictionary<string, frmScannerSearchCol.Engine.Macth> dictionary = this.SortMacth(o);
      try
      {
        foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Macth> keyValuePair in dictionary)
        {
          string domain = Globals.G_Utilities.GetDomain(keyValuePair.Key);
          ListViewGroup listViewGroup1 = (ListViewGroup) null;
          try
          {
            foreach (ListViewGroup listViewGroup2 in oGroups)
            {
              if (listViewGroup2.Header.Equals(domain))
              {
                listViewGroup1 = listViewGroup2;
                break;
              }
            }
          }
          finally
          {
            List<ListViewGroup>.Enumerator enumerator;
            enumerator.Dispose();
          }
          if (listViewGroup1 == null)
          {
            listViewGroup1 = new ListViewGroup(domain);
            oGroups.Add(listViewGroup1);
          }
          oItems.Add(new ListViewItem("URL")
          {
            SubItems = {
              keyValuePair.Key
            },
            Group = listViewGroup1
          });
          oItems.Add(new ListViewItem("Method")
          {
            SubItems = {
              keyValuePair.Value.Method
            },
            Group = listViewGroup1
          });
          if (string.IsNullOrEmpty(sSearch))
            oItems.Add(new ListViewItem("Total Rows")
            {
              SubItems = {
                Strings.FormatNumber((object) keyValuePair.Value.TotalRows, 0)
              },
              Group = listViewGroup1
            });
          keyValuePair.Value.Detalhes = this.SortTraget(keyValuePair.Value.Detalhes);
          try
          {
            foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Traget> detalhe in keyValuePair.Value.Detalhes)
            {
              if (string.IsNullOrEmpty(sSearch) || detalhe.Value.Search.Equals(sSearch))
              {
                if (string.IsNullOrEmpty(sSearch))
                  oItems.Add(new ListViewItem("Search")
                  {
                    SubItems = {
                      detalhe.Value.Search
                    },
                    Group = listViewGroup1
                  });
                oItems.Add(new ListViewItem("Rows")
                {
                  SubItems = {
                    Strings.FormatNumber((object) detalhe.Value.Rows, 0)
                  },
                  Group = listViewGroup1
                });
                try
                {
                  foreach (string str in detalhe.Value.Schema)
                    oItems.Add(new ListViewItem("")
                    {
                      SubItems = {
                        str
                      },
                      Group = listViewGroup1
                    });
                }
                finally
                {
                  List<string>.Enumerator enumerator;
                  enumerator.Dispose();
                }
              }
            }
          }
          finally
          {
            Dictionary<string, frmScannerSearchCol.Engine.Traget>.Enumerator enumerator;
            enumerator.Dispose();
          }
        }
      }
      finally
      {
        Dictionary<string, frmScannerSearchCol.Engine.Macth>.Enumerator enumerator;
        enumerator.Dispose();
      }
    }

    public void Sort()
    {
      this.Dict = this.SortMacth(this.Dict);
      try
      {
        foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Macth> keyValuePair in this.Dict)
        {
          keyValuePair.Value.Detalhes = this.SortTraget(keyValuePair.Value.Detalhes);
          try
          {
            foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Traget> detalhe in keyValuePair.Value.Detalhes)
              detalhe.Value.Schema = this.SortSchemaDesc(detalhe.Value.Schema);
          }
          finally
          {
            Dictionary<string, frmScannerSearchCol.Engine.Traget>.Enumerator enumerator;
            enumerator.Dispose();
          }
        }
      }
      finally
      {
        Dictionary<string, frmScannerSearchCol.Engine.Macth>.Enumerator enumerator;
        enumerator.Dispose();
      }
    }

    public void Add(
      string sURL,
      string sMethod,
      string sSearch,
      int iCount,
      List<string> lTables)
    {
      if (this.LVW.InvokeRequired)
      {
        this.LVW.Invoke((Delegate) new frmScannerSearchCol.Engine.DAdd(this.Add), (object) sURL, (object) sMethod, (object) sSearch, (object) iCount, (object) lTables);
      }
      else
      {
        frmScannerSearchCol.Engine.Macth macth;
        if (this.Dict.ContainsKey(sURL))
        {
          macth = this.Dict[sURL];
        }
        else
        {
          macth = new frmScannerSearchCol.Engine.Macth();
          this.Dict.Add(sURL, macth);
        }
        checked { macth.TotalRows += iCount; }
        macth.Method = sMethod;
        frmScannerSearchCol.Engine.Traget traget;
        if (macth.Detalhes.ContainsKey(sSearch))
        {
          traget = macth.Detalhes[sSearch];
          traget.Schema.AddRange((IEnumerable<string>) lTables.ToArray());
        }
        else
        {
          traget = new frmScannerSearchCol.Engine.Traget();
          traget.Search = sSearch;
          traget.Rows = iCount;
          traget.Schema = lTables;
          macth.Detalhes.Add(sSearch, traget);
        }
        traget.Schema = this.SortSchemaDesc(traget.Schema);
        if (!this.Search.Contains(sSearch))
          this.Search.Add(sSearch);
        if (!this.AddItems)
          return;
        lock (this.LVW)
        {
          if (!this.LST.Items.Contains((object) sSearch))
            this.LST.Items.Add((object) sSearch);
          if (this.LST.SelectedIndex > 0 && !this.LST.SelectedItem.Equals((object) sSearch) || traget.Rows < this.MiniRows)
            return;
          string domain = Globals.G_Utilities.GetDomain(sURL);
          ListViewGroup group = this.LVW.GetGroupByHeader(domain);
          Globals.LockWindowUpdate(this.LVW.Handle);
          if (group == null)
          {
            group = new ListViewGroup(domain);
            this.LVW.Groups.Add(group);
            this.LVW.Items.Add(new ListViewItem("URL")
            {
              SubItems = {
                sURL
              },
              Group = group
            });
            this.LVW.Items.Add(new ListViewItem("Method")
            {
              SubItems = {
                macth.Method
              },
              Group = group
            });
          }
          if (macth.Detalhes.Count > 1)
            this.LVW.Items.Add(new ListViewItem("Total Rows")
            {
              SubItems = {
                Strings.FormatNumber((object) macth.TotalRows, 0)
              },
              Group = group
            });
          try
          {
            foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Traget> detalhe in macth.Detalhes)
            {
              if (detalhe.Value.Search.Equals(sSearch))
              {
                this.LVW.Items.Add(new ListViewItem("Search")
                {
                  SubItems = {
                    detalhe.Value.Search
                  },
                  Group = group
                });
                this.LVW.Items.Add(new ListViewItem("Rows")
                {
                  SubItems = {
                    Strings.FormatNumber((object) detalhe.Value.Rows, 0)
                  },
                  Group = group
                });
                try
                {
                  foreach (string str in detalhe.Value.Schema)
                    this.LVW.Items.Add(new ListViewItem("")
                    {
                      SubItems = {
                        str
                      },
                      Group = group
                    });
                }
                finally
                {
                  List<string>.Enumerator enumerator;
                  enumerator.Dispose();
                }
              }
            }
          }
          finally
          {
            Dictionary<string, frmScannerSearchCol.Engine.Traget>.Enumerator enumerator;
            enumerator.Dispose();
          }
          Globals.LockWindowUpdate(IntPtr.Zero);
        }
      }
    }

    private Dictionary<string, frmScannerSearchCol.Engine.Traget> SortTraget(
      Dictionary<string, frmScannerSearchCol.Engine.Traget> o)
    {
      Dictionary<string, frmScannerSearchCol.Engine.Traget> dictionary = new Dictionary<string, frmScannerSearchCol.Engine.Traget>();
      int num = 0;
      KeyValuePair<string, frmScannerSearchCol.Engine.Traget> keyValuePair1 = new KeyValuePair<string, frmScannerSearchCol.Engine.Traget>();
      while (o.Count > 0)
      {
        try
        {
          foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Traget> keyValuePair2 in o)
          {
            if (keyValuePair2.Value.Rows > num)
            {
              num = keyValuePair2.Value.Rows;
              keyValuePair1 = keyValuePair2;
            }
          }
        }
        finally
        {
          Dictionary<string, frmScannerSearchCol.Engine.Traget>.Enumerator enumerator;
          enumerator.Dispose();
        }
        dictionary.Add(keyValuePair1.Key, keyValuePair1.Value);
        o.Remove(keyValuePair1.Key);
        num = 0;
      }
      return dictionary;
    }

    private Dictionary<string, frmScannerSearchCol.Engine.Macth> SortMacth(
      Dictionary<string, frmScannerSearchCol.Engine.Macth> o)
    {
      Dictionary<string, frmScannerSearchCol.Engine.Macth> dictionary = new Dictionary<string, frmScannerSearchCol.Engine.Macth>();
      int num = 0;
      KeyValuePair<string, frmScannerSearchCol.Engine.Macth> keyValuePair1 = new KeyValuePair<string, frmScannerSearchCol.Engine.Macth>();
      while (o.Count > 0)
      {
        try
        {
          foreach (KeyValuePair<string, frmScannerSearchCol.Engine.Macth> keyValuePair2 in o)
          {
            if (keyValuePair2.Value.TotalRows > num)
            {
              num = keyValuePair2.Value.TotalRows;
              keyValuePair1 = keyValuePair2;
            }
          }
        }
        finally
        {
          Dictionary<string, frmScannerSearchCol.Engine.Macth>.Enumerator enumerator;
          enumerator.Dispose();
        }
        dictionary.Add(keyValuePair1.Key, keyValuePair1.Value);
        o.Remove(keyValuePair1.Key);
        num = 0;
      }
      return dictionary;
    }

    private List<string> SortSchemaDesc(List<string> o)
    {
      List<string> stringList = new List<string>();
      int num = 0;
      string str1 = "";
      while (o.Count > 0)
      {
        try
        {
          foreach (string str2 in o)
          {
            int integer = Conversions.ToInteger(str2.Substring(checked (str2.IndexOf("[") + 1), checked (str2.IndexOf("]") - 1)));
            if (integer > num)
            {
              num = integer;
              str1 = str2;
            }
          }
        }
        finally
        {
          List<string>.Enumerator enumerator;
          enumerator.Dispose();
        }
        stringList.Add(str1);
        o.Remove(str1);
        num = 0;
      }
      return stringList;
    }

    public Engine(bool bItems, ListViewExt lw, ToolStripComboBox cb)
    {
      this.Search = new List<string>();
      this.Dict = new Dictionary<string, frmScannerSearchCol.Engine.Macth>();
      this.AddItems = bItems;
      this.LVW = lw;
      this.LST = cb;
    }

    public delegate void DAdd(
      string sURL,
      string sMethod,
      string sSearch,
      int iCount,
      List<string> lTables);

    public class Macth
    {
      public Macth() => this.Detalhes = new Dictionary<string, frmScannerSearchCol.Engine.Traget>();

      public string Method { get; set; }

      public int TotalRows { get; set; }

      public Dictionary<string, frmScannerSearchCol.Engine.Traget> Detalhes { get; set; }
    }

    public class Traget
    {
      public string Search { get; set; }

      public int Rows { get; set; }

      public List<string> Schema { get; set; }
    }
  }

  private delegate void DRefreshGUI(List<ListViewItem> oItems, List<ListViewGroup> oGroup);
}
