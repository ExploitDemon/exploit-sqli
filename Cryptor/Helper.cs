// Decompiled with JetBrains decompiler
// Type: Cryptor.Helper
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

namespace Cryptor
{
  internal class Helper
  {
    public static bool EncryptFile(string sPath, Method m, string sPass)
    {
      bool flag;
      try
      {
        if (!File.Exists(sPath))
        {
          flag = true;
        }
        else
        {
          byte[] bytData = File.ReadAllBytes(sPath);
          if (bytData.Length == 0)
          {
            flag = true;
          }
          else
          {
            switch (m)
            {
              case Method.RijnDael:
                bytData = RijnDael.Encrypt(bytData, sPass);
                break;
              case Method.RC4:
                bytData = RC4.Encrypt(bytData, sPass);
                break;
              case Method.MD5:
                bytData = MD5.Encrypt(bytData, sPass);
                break;
              case Method.XOR:
                bytData = XOR.Encrypt(bytData, sPass);
                break;
            }
            byte[] bytes = Compression.Compress((byte[]) Utils.CopyArray((Array) bytData, (Array) new byte[checked (bytData.Length - 1 + 1)]));
            File.Delete(sPath);
            File.WriteAllBytes(sPath, bytes);
            flag = true;
          }
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        int num = (int) MessageBox.Show(ex.Message, "Encrypt failed", MessageBoxButtons.OK, MessageBoxIcon.Hand);
        ProjectData.ClearProjectError();
      }
      return flag;
    }

    public static bool DecryptFile(string sPath, Method m, string sPass)
    {
      bool flag;
      try
      {
        if (!File.Exists(sPath))
        {
          flag = true;
        }
        else
        {
          byte[] bytData = File.ReadAllBytes(sPath);
          if (bytData.Length == 0)
          {
            flag = true;
          }
          else
          {
            byte[] numArray = Compression.Decompress(bytData);
            switch (m)
            {
              case Method.RijnDael:
                numArray = RijnDael.Decrypt(numArray, sPass);
                break;
              case Method.RC4:
                numArray = RC4.Decrypt(numArray, sPass);
                break;
              case Method.MD5:
                numArray = MD5.Decrypt(numArray, sPass);
                break;
              case Method.XOR:
                numArray = XOR.Decrypt(numArray, sPass);
                break;
            }
            File.Delete(sPath);
            File.WriteAllBytes(sPath, numArray);
            flag = true;
          }
        }
      }
      catch (Exception ex)
      {
        ProjectData.SetProjectError(ex);
        Exception exception = ex;
        if (!Debugger.IsAttached)
        {
          int num = (int) MessageBox.Show(exception.Message + "\r\n\r\n" + sPath, "Decrypt failed", MessageBoxButtons.OK, MessageBoxIcon.Hand);
        }
        ProjectData.ClearProjectError();
      }
      return flag;
    }
  }
}
