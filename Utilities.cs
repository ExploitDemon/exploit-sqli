// Decompiled with JetBrains decompiler
// Type: Utilities
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Globalization;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;

public class Utilities
{
  public int FindNumeric(string sText, bool bLastIndexOf)
  {
    Match match = new Regex("\\d+").Match(sText);
    if (!match.Success)
      return 0;
    int num;
    if (bLastIndexOf)
    {
      for (; match.Success; match = match.NextMatch())
        num = checked (match.Index + match.Value.Length + 1);
    }
    return num == 0 ? checked (match.Index + match.Value.Length + 1) : 0;
  }

  public string GetDomain(string sUrlEntered)
  {
    string str;
    try
    {
      str = new Uri(sUrlEntered).Host.Replace("www.", "");
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = "";
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public string GetDomainCode(string sUrlEntered)
  {
    try
    {
      Uri uri = new Uri(sUrlEntered);
      int num = uri.Host.LastIndexOf(".");
      if (num > 0)
        return uri.Host.Substring(checked (num + 1));
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return "";
  }

  public long CharCount(string OrigString, string Chars, bool CaseSensitive = false)
  {
    string str = OrigString;
    long num1;
    if (Operators.CompareString(str, "", false) != 0)
    {
      long num2 = (long) Strings.Len(str);
      long num3 = (long) Strings.Len(Chars);
      long num4 = checked (num2 - num3 + 1L);
      byte num5 = Conversions.ToByte(Interaction.IIf(CaseSensitive, (object) CompareMethod.Binary, (object) CompareMethod.Text));
      long num6 = num4;
      long num7 = 1;
      long num8;
      while (num7 <= num6)
      {
        if (Strings.StrComp(Strings.Mid(str, checked ((int) num7), checked ((int) num3)), Chars, (CompareMethod) num5) == 0)
          checked { ++num8; }
        checked { ++num7; }
      }
      num1 = num8;
    }
    return num1;
  }

  public string ConvertHexToText(string sText)
  {
    string str1;
    try
    {
      if (string.IsNullOrEmpty(sText))
      {
        str1 = "";
      }
      else
      {
        string str2 = sText;
        string str3 = "";
        if (str2.StartsWith("0x"))
          str2 = str2.Substring(2);
        int startIndex = 0;
        while (startIndex < str2.Length)
        {
          string s = str2.Substring(startIndex, 2);
          str3 += Conversions.ToString(Strings.ChrW(checked ((int) uint.Parse(s, NumberStyles.HexNumber))));
          checked { startIndex += 2; }
        }
        if (str3.Contains("\x0012"))
          str3 = Conversions.ToString(Conversion.Val("&H" + sText));
        str1 = str3;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str1 = sText;
      ProjectData.ClearProjectError();
    }
    return str1;
  }

  public string ConvertTextToHex(string sText)
  {
    string str1;
    try
    {
      if (string.IsNullOrEmpty(sText))
      {
        str1 = "";
      }
      else
      {
        byte[] bytes = Encoding.ASCII.GetBytes(sText.ToCharArray());
        string str2 = "";
        int num = checked (bytes.Length - 1);
        int index = 0;
        while (index <= num)
        {
          str2 += string.Format("{0:x2}", (object) bytes[index]);
          checked { ++index; }
        }
        str1 = "0x" + str2;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str1 = sText;
      ProjectData.ClearProjectError();
    }
    return str1;
  }

  public string ConvertTextToSQLChar(
    string sText,
    bool bGroupChar,
    string sDelimiter = "+",
    string sChar = "char")
  {
    string str1;
    try
    {
      if (string.IsNullOrEmpty(sText))
      {
        str1 = "";
      }
      else
      {
        byte[] bytes = Encoding.ASCII.GetBytes(sText.ToCharArray());
        string str2 = "";
        int num = checked (bytes.Length - 1);
        int index = 0;
        while (index <= num)
        {
          if (bGroupChar)
            str2 = index != 0 ? str2 + "," + Convert.ToString(bytes[index]) : str2 + sChar + "(" + Convert.ToString(bytes[index]);
          else if (index == 0)
            str2 = str2 + sChar + "(" + Convert.ToString(bytes[index]) + ")";
          else
            str2 = str2 + sDelimiter + sChar + "(" + Convert.ToString(bytes[index]) + ")";
          checked { ++index; }
        }
        if (bGroupChar)
          str2 += ")";
        str1 = str2;
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str1 = "ERROR: " + ex.Message;
      ProjectData.ClearProjectError();
    }
    return str1;
  }

  public string EncodeURL(string sData)
  {
    if (string.IsNullOrEmpty(sData))
      return "";
    sData = sData.Replace("  ", " ");
    return HttpUtility.UrlEncodeUnicode(sData);
  }

  public string DecodeURL(string sData)
  {
    if (string.IsNullOrEmpty(sData))
      return "";
    return sData.ToLower().StartsWith("http://") | sData.ToLower().StartsWith("https://") ? HttpUtility.UrlDecode(sData) : HttpUtility.HtmlDecode(sData);
  }

  public string EncodeCookie(string sData, bool encodeEqualSign)
  {
    if (string.IsNullOrEmpty(sData))
      return "";
    sData = sData.Replace("%", "%25");
    sData = sData.Replace("#", "%23");
    sData = sData.Replace("+", "%2B");
    sData = sData.Replace(" ", "+");
    sData = sData.Replace("'", "%27");
    if (encodeEqualSign)
      sData = sData.Replace("=", "%3D");
    sData = sData.Replace("(", "%28");
    sData = sData.Replace(")", "%29");
    sData = sData.Replace(";", "%3b");
    return sData;
  }

  public Cookie GetAsCookie(string CookieString, Uri Uri)
  {
    string empty1 = string.Empty;
    string empty2 = string.Empty;
    this.ParseParameter(CookieString, ref empty2, ref empty1);
    return new Cookie(empty2.Replace("\n", string.Empty).Replace("\r", string.Empty).Replace("\t", string.Empty).TrimStart(' '), empty1, "/", Uri.Host);
  }

  public void ParseParameter(string RawString, ref string Name, ref string Value, char Identifier = '=')
  {
    int length = RawString.IndexOf(Identifier);
    if (length == -1)
      return;
    Name = RawString.Substring(0, length);
    Value = RawString.Substring(checked (length + 1), checked (RawString.Length - length - 1));
  }

  public char Char(int asciiCode) => Conversions.ToChar(Conversions.ToChar(Conversions.ToString(asciiCode)).ToString());

  public string GetNewGETUrl(string newQuery, string currentUri) => new Uri(currentUri).GetLeftPart(UriPartial.Path) + "?" + newQuery;

  public bool IsNumeric(string valueToCheck)
  {
    bool flag;
    try
    {
      int.Parse(valueToCheck);
      goto label_3;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      flag = false;
      ProjectData.ClearProjectError();
    }
    return flag;
label_3:
    return true;
  }

  public bool IsIpAddressValid(string ipAddress) => new Regex("\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b", RegexOptions.None).Match(ipAddress).Success;

  public bool IsUrlValid(string sURL)
  {
    bool flag;
    try
    {
      if (sURL.StartsWith("http://") | sURL.StartsWith("https://"))
        flag = true;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return flag;
  }

  public bool IsDomain(string domain) => new Regex("^([a-zA-Z0-9]([a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,6}$").IsMatch(domain);

  public bool IsIP(string ip)
  {
    Regex regex = new Regex("^(?:(?:25[0-5]|2[0-4]\\d|[01]\\d\\d|\\d?\\d)(?(\\.?\\d)\\.)){4}$");
    bool flag;
    try
    {
      flag = regex.IsMatch(ip);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      flag = false;
      ProjectData.ClearProjectError();
    }
    return flag;
  }

  public string FormatBytes(double dblBytes)
  {
    double num = dblBytes;
    if (num >= 1.12589990684262E+15)
      return Conversions.ToString(Math.Round(dblBytes / 1.12589990684262E+15, 2)) + " PiB";
    if (num >= 1099511627776.0)
      return Conversions.ToString(Math.Round(dblBytes / 1099511627776.0, 2)) + " TiB";
    if (num >= 1073741824.0)
      return Conversions.ToString(Math.Round(dblBytes / 1073741824.0, 2)) + " GiB";
    if (num >= 1048576.0)
      return Conversions.ToString(Math.Round(dblBytes / 1048576.0, 2)) + " MiB";
    return num >= 1024.0 ? Conversions.ToString(Math.Round(dblBytes / 1024.0, 2)) + " KiB" : Conversions.ToString(dblBytes) + " Bytes";
  }

  public string StrExtract(char cStart, char cEnd, string sData)
  {
    string str;
    try
    {
      int num1 = sData.IndexOf(cStart);
      int num2 = sData.IndexOf(cEnd);
      str = sData.Substring(checked (num1 + 1), checked (num2 - num1 - 1));
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = "";
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public string StrJoin(char sEnd, char cStart, string sData)
  {
    string str;
    try
    {
      int num1 = sData.IndexOf(sEnd);
      int num2 = sData.LastIndexOf(cStart);
      str = sData.Substring(checked (num1 + 1), checked (num2 - num1 - 1));
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      str = "";
      ProjectData.ClearProjectError();
    }
    return str;
  }

  public IPAddress HostNameToIP(string sAddress)
  {
    IPAddress ipAddress1;
    try
    {
      IPAddress[] addressList = Dns.GetHostEntry(sAddress).AddressList;
      int index = 0;
      while (index < addressList.Length)
      {
        IPAddress ipAddress2 = addressList[index];
        if (ipAddress2.AddressFamily != AddressFamily.InterNetwork)
        {
          checked { ++index; }
        }
        else
        {
          ipAddress1 = ipAddress2;
          goto label_7;
        }
      }
      ipAddress1 = (IPAddress) null;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ipAddress1 = (IPAddress) null;
      ProjectData.ClearProjectError();
    }
label_7:
    return ipAddress1;
  }

  public string UrlToIP(string sURL)
  {
    try
    {
      string sAddress = "";
      bool flag = true;
      if (sURL.ToLower().StartsWith("http"))
      {
        string[] strArray = Regex.Split(sURL.Trim(), "/");
        if (!Information.IsNothing((object) strArray) && strArray.Length >= 2)
          sAddress = strArray[2];
      }
      else if (flag == sURL.Contains(":"))
        sAddress = sURL.Split(':')[0];
      else
        sAddress = sURL;
      return Globals.G_Utilities.HostNameToIP(sAddress).ToString();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    return "";
  }
}
