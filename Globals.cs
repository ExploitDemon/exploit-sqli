// Decompiled with JetBrains decompiler
// Type: Globals
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Windows.Forms;

[StandardModule]
internal sealed class Globals
{
  public static enGUI G_GUI;
  public static frmMain G_Main;
  public static frmScanner G_Scanner;
  public static frmAnalizer G_Counter;
  public static frmDumpArea G_Dumper;
  public static frmBruteForce G_Bruter;
  public static frmDumpFile G_LoadFile;
  public static frmBlind G_Blinder;
  public static frmTools G_Tools;
  public static frmSplash G_Splash;
  public static Proxy G_Proxy = new Proxy();
  public static Settings G_Settings;
  public static cXML G_XML;
  public static GeoIP G_GEOIP;
  public static Utilities G_Utilities = new Utilities();
  public static long TRAFFIC_RECEIVED;
  public static string USER_AGENT;
  public static bool HTTP_ALLOW_AUTO_REDIRECT;
  public static bool HTTP_ENCONDING_HEADERS;
  public static string G_KEY = "";
  public const string INJECTION_TRAJECT = "[t]";
  public static string DATA_SPLIT_STR = "!k3y!";
  public static string DATA_SPLIT = Globals.G_Utilities.ConvertTextToHex(Globals.DATA_SPLIT);
  public static string REGEXP_CAPTURE = Globals.DATA_SPLIT + "(.+)" + Globals.DATA_SPLIT;
  public static string COLLUMNS_SPLIT_STR = "8pl1t";
  public static string COLLUMNS_SPLIT = Globals.G_Utilities.ConvertTextToHex(Globals.COLLUMNS_SPLIT_STR);
  public static string URL_REPLACE_SPACES = "+";
  public static bool NETWORK_AVAILABLE = true;
  public const bool PIZZA_STUFFS = true;
  public static readonly string APP_VERSION = "SQLi Dumper v.8.5 | Very Clean - Stephanny";
  public static readonly string APP_PATH = Application.StartupPath;
  public static readonly string TXT_URL_PATH = Globals.APP_PATH + "\\TXT\\";
  public static readonly string TXT_DIC_PATH = Globals.APP_PATH + "\\DIC\\";
  public static readonly string DUMP_SCHEMA_PATH = Globals.APP_PATH + "\\XML\\";
  public static readonly string XML_PATH = Globals.APP_PATH + "\\Settings.xml";
  public static readonly string GEO_IP_PATH = Globals.APP_PATH + "\\GeoIP.dat";
  public static readonly string TXT_URL_LIST = Globals.TXT_URL_PATH + "URL List.txt";
  public static readonly string TXT_URL_EXPLOITABLES = Globals.TXT_URL_PATH + "URL Exploitables.xml";
  public static readonly string TXT_URL_PRE_TRASHED = Globals.TXT_URL_PATH + "URL NonInjectables.xml";
  public static readonly string TXT_URL_INJECTABLES = Globals.TXT_URL_PATH + "URL Injectables.xml";
  public static readonly string TXT_URL_INJECTABLES_ARCHIVED = Globals.TXT_URL_PATH + "URL InjectablesArchived.xml";
  public static readonly string TXT_URL_TRASH = Globals.TXT_URL_PATH + "URL Trash.txt";
  public const string UNION_INJECT_INTEGER = "999999.9 union all select [n]";
  public const string UNION_INJECT_STRING = "999999.9' union all select [n] and '0'='0";
  public static bool SYS_TRAY_ICON;
  public static bool RESTART_MODE;
  public static frmHttpDebug G_LOG;
  public static string MY_IP_ADRESS;
  public static string PROXY_IP;
  public static Globals.WorkerPauseCallback WRKPause;
  private static string __URL;

  [MethodImpl(MethodImplOptions.NoOptimization)]
  static Globals()
  {
  }

  [DllImport("user32.dll")]
  private static extern int GetWindowLong(IntPtr hWnd, int nIndex);

  [DllImport("user32.dll")]
  private static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);

  [DllImport("user32.dll")]
  private static extern bool SetWindowPos(
    IntPtr hWnd,
    IntPtr hWndInsertAfter,
    int X,
    int Y,
    int cx,
    int cy,
    uint uFlags);

  [DllImport("user32.dll")]
  public static extern bool LockWindowUpdate(IntPtr hWndLock);

  public static bool AppIsAlreadyRunning()
  {
    bool flag;
    return Process.GetProcessesByName(Path.GetFileNameWithoutExtension(Process.GetCurrentProcess().MainModule.ModuleName)).Length > 1 || flag;
  }

  public static string DecodeBase32(string Base32String)
  {
    string str1 = Base32String.Replace("-", "");
    List<byte> byteList1 = new List<byte>();
    string str2 = str1;
    int index = 0;
    int length = str2.Length;
    while (index < length)
    {
      int num = Globals.CharToValue(str2[index]);
      byteList1.Add((num & 16) > 0 ? (byte) 1 : (byte) 0);
      byteList1.Add((num & 8) > 0 ? (byte) 1 : (byte) 0);
      byteList1.Add((num & 4) > 0 ? (byte) 1 : (byte) 0);
      byteList1.Add((num & 2) > 0 ? (byte) 1 : (byte) 0);
      byteList1.Add((num & 1) > 0 ? (byte) 1 : (byte) 0);
      checked { ++index; }
    }
    List<byte> byteList2 = new List<byte>();
    int num1 = checked (byteList1.Count - 1);
    int num2 = 0;
    while (num2 <= num1)
    {
      byteList2.Add(checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) checked ((byte) unchecked ((int) (byte) ((uint) byteList1[checked (num2 + 0)] << 7) + (int) (byte) ((uint) byteList1[checked (num2 + 1)] << 6))) + (int) (byte) ((uint) byteList1[checked (num2 + 2)] << 5))) + (int) (byte) ((uint) byteList1[checked (num2 + 3)] << 4))) + (int) (byte) ((uint) byteList1[checked (num2 + 4)] << 3))) + (int) (byte) ((uint) byteList1[checked (num2 + 5)] << 2))) + (int) (byte) ((uint) byteList1[checked (num2 + 6)] << 1))) + (int) (byte) ((uint) byteList1[checked (num2 + 7)] << 0))));
      checked { num2 += 8; }
    }
    return new ASCIIEncoding().GetString(byteList2.ToArray());
  }

  private static int CharToValue(char c)
  {
    switch (char.ToLower(c))
    {
      case '2':
        return 26;
      case '3':
        return 27;
      case '4':
        return 28;
      case '5':
        return 29;
      case '6':
        return 30;
      case '7':
        return 31;
      case 'a':
        return 0;
      case 'b':
        return 1;
      case 'c':
        return 2;
      case 'd':
        return 3;
      case 'e':
        return 4;
      case 'f':
        return 5;
      case 'g':
        return 6;
      case 'h':
        return 7;
      case 'i':
        return 8;
      case 'j':
        return 9;
      case 'k':
        return 10;
      case 'l':
        return 11;
      case 'm':
        return 12;
      case 'n':
        return 13;
      case 'o':
        return 14;
      case 'p':
        return 15;
      case 'q':
        return 16;
      case 'r':
        return 17;
      case 's':
        return 18;
      case 't':
        return 19;
      case 'u':
        return 20;
      case 'v':
        return 21;
      case 'w':
        return 22;
      case 'x':
        return 23;
      case 'y':
        return 24;
      case 'z':
        return 25;
      default:
        return -1;
    }
  }

  public static void FlatBorder(IntPtr hWnd)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      int dwNewLong = Globals.GetWindowLong(hWnd, -20);
label_2:
      num3 = 3;
      dwNewLong = dwNewLong & -513 | 131072;
label_3:
      num3 = 4;
      Globals.SetWindowLong(hWnd, -20, dwNewLong);
label_4:
      num3 = 5;
      Globals.SetWindowPos(hWnd, IntPtr.Zero, 0, 0, 0, 0, 55U);
      goto label_11;
label_6:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_11;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_6;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_11:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public static void UpDateStatus(string sText)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      if (!Globals.G_Main.InvokeRequired)
        goto label_3;
label_2:
      num3 = 3;
      Globals.G_Main.Invoke((Delegate) new Globals.DelegateUpDateStatus(Globals.UpDateStatus), (object) sText);
      goto label_11;
label_3:
      num3 = 5;
label_4:
      num3 = 6;
      Globals.G_Main.lblStatus.Text = sText;
      goto label_11;
label_6:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
            case 7:
            case 8:
              goto label_11;
            case 5:
              goto label_3;
            case 6:
              goto label_4;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_6;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_11:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public static void OpenLoading(ref frmLoading o, ref Form oOwner, ProgressBarStyle pBarStyle = ProgressBarStyle.Blocks)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      o = new frmLoading();
label_2:
      num3 = 3;
      o.prgStatus.Value = 0;
label_3:
      num3 = 4;
      o.prgStatus.Maximum = 100;
label_4:
      num3 = 5;
      o.prgStatus.Style = pBarStyle;
label_5:
      num3 = 6;
      if (o.prgStatus.Style == ProgressBarStyle.Blocks)
        goto label_7;
label_6:
      num3 = 7;
      o.prgStatus.PercentageVisible = false;
      goto label_9;
label_7:
      num3 = 9;
label_8:
      num3 = 10;
      o.prgStatus.PercentageVisible = true;
label_9:
      num3 = 12;
      o.prgStatus.BringToFront();
label_10:
      num3 = 13;
      o.prgStatus.Visible = true;
label_11:
      num3 = 14;
      Control pnlNack = (Control) Globals.GetPnlNack(oOwner);
label_12:
      num3 = 15;
      if (pnlNack == null)
        goto label_14;
label_13:
      num3 = 16;
      pnlNack.Controls.Add((Control) o.grbBack);
      goto label_16;
label_14:
      num3 = 18;
label_15:
      num3 = 19;
      oOwner.Controls.Add((Control) o.grbBack);
label_16:
      num3 = 21;
      o.Dock = DockStyle.Bottom;
      goto label_23;
label_18:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_6;
            case 8:
            case 11:
            case 12:
              goto label_9;
            case 9:
              goto label_7;
            case 10:
              goto label_8;
            case 13:
              goto label_10;
            case 14:
              goto label_11;
            case 15:
              goto label_12;
            case 16:
              goto label_13;
            case 17:
            case 20:
            case 21:
              goto label_16;
            case 18:
              goto label_14;
            case 19:
              goto label_15;
            case 22:
              goto label_23;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_18;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_23:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public static void CloseLoading(ref frmLoading o, ref Form oOwner)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      if (o == null)
        goto label_16;
label_2:
      num3 = 5;
      if (o == null)
        goto label_16;
label_3:
      num3 = 6;
      Control pnlNack = (Control) Globals.GetPnlNack(oOwner);
label_4:
      num3 = 7;
      if (pnlNack == null)
        goto label_6;
label_5:
      num3 = 8;
      pnlNack.Controls.Remove((Control) o.grbBack);
      goto label_8;
label_6:
      num3 = 10;
label_7:
      num3 = 11;
      oOwner.Controls.Remove((Control) o.grbBack);
label_8:
      num3 = 13;
      o.Close();
label_9:
      num3 = 14;
      o.Dispose();
      goto label_16;
label_11:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
            case 15:
            case 16:
              goto label_16;
            case 4:
            case 5:
              goto label_2;
            case 6:
              goto label_3;
            case 7:
              goto label_4;
            case 8:
              goto label_5;
            case 9:
            case 12:
            case 13:
              goto label_8;
            case 10:
              goto label_6;
            case 11:
              goto label_7;
            case 14:
              goto label_9;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_11;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_16:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public static void UpDateLoading(
    ref frmLoading o,
    int intValue,
    ref bool bStopPressed,
    string sStatus = "")
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      if (o == null)
        goto label_19;
label_2:
      num3 = 3;
      if (!o.InvokeRequired)
        goto label_4;
label_3:
      num3 = 4;
      o.Invoke((Delegate) new Globals.DelegateUpDateLoading(Globals.UpDateLoading), (object) o, (object) intValue, (object) bStopPressed, (object) sStatus);
      goto label_19;
label_4:
      num3 = 6;
label_5:
      num3 = 7;
      if (intValue < 0)
        goto label_7;
label_6:
      num3 = 8;
      o.prgStatus.Value = intValue;
label_7:
      num3 = 10;
      if (!(intValue >= 0 & !string.IsNullOrEmpty(sStatus)))
        goto label_12;
label_8:
      num3 = 11;
      if (Operators.CompareString(sStatus, "", false) == 0)
        goto label_10;
label_9:
      num3 = 12;
      o.grbBack.TitleText = Conversions.ToString(Operators.ConcatenateObject((object) ("Loading, please wait [" + sStatus + "]"), Interaction.IIf(o.prgStatus.PercentageVisible & o.grbBack.HasCollapsed, (object) (" " + Conversions.ToString(intValue) + "%"), (object) "")));
      goto label_12;
label_10:
      num3 = 14;
label_11:
      num3 = 15;
      o.grbBack.TitleText = Conversions.ToString(Operators.ConcatenateObject((object) "Loading, please wait ", Interaction.IIf(o.prgStatus.PercentageVisible & o.grbBack.HasCollapsed, (object) (" " + Conversions.ToString(intValue) + "%"), (object) "")));
label_12:
      num3 = 18;
      bStopPressed = o.Canceling;
      goto label_19;
label_14:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
            case 19:
            case 20:
            case 21:
              goto label_19;
            case 6:
              goto label_4;
            case 7:
              goto label_5;
            case 8:
              goto label_6;
            case 9:
            case 10:
              goto label_7;
            case 11:
              goto label_8;
            case 12:
              goto label_9;
            case 13:
            case 16:
            case 17:
            case 18:
              goto label_12;
            case 14:
              goto label_10;
            case 15:
              goto label_11;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_14;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_19:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public static string FileOpen(string sFileName)
  {
    string str1;
    try
    {
      string str2 = sFileName;
      if (!File.Exists(sFileName))
        sFileName = Globals.APP_PATH;
      using (OpenFileDialog openFileDialog = new OpenFileDialog())
      {
        openFileDialog.FileName = sFileName;
        openFileDialog.Multiselect = false;
        if ((uint) openFileDialog.ShowDialog() > 0U)
          str2 = openFileDialog.FileName;
      }
      str1 = str2;
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message);
      str1 = "";
      ProjectData.ClearProjectError();
    }
    return str1;
  }

  private static Panel GetPnlNack(Form o)
  {
    if (Globals.G_Main.IS_DUMP_INSTANCE)
      return Globals.G_Dumper.pnlBack;
    Hashtable hashtable = Globals.G_Settings.EnumerateAllControlsOnAForm(o);
    return hashtable.Contains((object) "pnlBack") ? (Panel) hashtable[(object) "pnlBack"] : (Panel) null;
  }

  public static void ShellURL(string sURL)
  {
    Globals.__URL = sURL;
    new Thread(new ThreadStart(Globals.IShell)).Start();
  }

  private static void IShell()
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      Process.Start(Globals.__URL);
      goto label_8;
label_3:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_8;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_3;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_8:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private delegate void DelegateUpDateStatus(string sText);

  private delegate void DelegateUpDateLoading(
    ref frmLoading o,
    int intValue,
    ref bool bStopPressed,
    string sStatus);

  public delegate void WorkerPauseCallback(bool bPaused);
}
