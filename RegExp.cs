// Decompiled with JetBrains decompiler
// Type: RegExp
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using System;
using System.Collections;
using System.Text.RegularExpressions;

public class RegExp : IDisposable
{
  private bool __Disposed;

  protected virtual void Dispose(bool b)
  {
    if (!this.__Disposed)
      ;
    this.__Disposed = true;
  }

  public void Dispose()
  {
    this.Dispose(true);
    GC.SuppressFinalize((object) this);
  }

  public string Replace(string sPattern, string sInput, string sValue)
  {
    Regex regex = new Regex(sPattern, RegexOptions.IgnoreCase | RegexOptions.IgnorePatternWhitespace);
    regex.Match(sInput);
    string str = regex.Replace(sInput, sValue);
    return string.IsNullOrEmpty(str) ? sInput : str;
  }

  public Hashtable Match(string sPattern, string sData, RegexOptions o)
  {
    Hashtable hashtable = new Hashtable();
    for (System.Text.RegularExpressions.Match match = new Regex(sPattern, o).Match(sData); match.Success; match = match.NextMatch())
      hashtable.Add((object) match.Index.ToString(), (object) new RegExpResult()
      {
        Index = match.Index,
        Value = match.Groups[1].Value
      });
    return hashtable;
  }

  public Hashtable GetData(string sData, string sRegExPattern)
  {
    Hashtable hashtable1 = this.Match(sRegExPattern, sData, RegexOptions.IgnoreCase);
    Hashtable hashtable2 = new Hashtable();
    if (hashtable1.Count == 0)
      return hashtable2;
    try
    {
      foreach (RegExpResult regExpResult in (IEnumerable) hashtable1.Values)
        hashtable2.Add((object) hashtable2.Count.ToString(), (object) regExpResult.Value);
    }
    finally
    {
      IEnumerator enumerator;
      if (enumerator is IDisposable)
        (enumerator as IDisposable).Dispose();
    }
    return hashtable2;
  }

  public string GetItemData(string sData, string sPattern, string sDefautValue = "")
  {
    for (System.Text.RegularExpressions.Match match = new Regex(sPattern, RegexOptions.IgnoreCase).Match(sData); match.Success; match = match.NextMatch())
    {
      if (!string.IsNullOrEmpty(match.Groups[1].Value))
        return match.Groups[1].Value;
    }
    return sDefautValue;
  }

  public Hashtable SplitData(string sData, string sFind)
  {
    Hashtable hashtable = new Hashtable();
    string[] strArray = Regex.Split(sData, sFind);
    int index = 0;
    while (index < strArray.Length)
    {
      string str = strArray[index];
      if (!hashtable.Contains((object) str))
        hashtable.Add((object) str, (object) str);
      checked { ++index; }
    }
    return hashtable;
  }

  public Hashtable GetLinks(string sUrl, string sData, string sRegExPattern)
  {
    Hashtable hashtable1 = this.Match(sRegExPattern, sData, RegexOptions.IgnoreCase);
    Hashtable hashtable2 = new Hashtable();
    if (hashtable1.Count == 0)
      return hashtable2;
    if (string.IsNullOrEmpty(sUrl))
    {
      try
      {
        foreach (RegExpResult regExpResult in (IEnumerable) hashtable1.Values)
          hashtable2.Add((object) hashtable2.Count.ToString(), (object) regExpResult.Value);
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      return hashtable2;
    }
    string[] strArray = Regex.Split(sUrl, "/");
    string str = strArray[0] + "//" + strArray[2];
    try
    {
      foreach (RegExpResult oResult in (IEnumerable) hashtable1.Values)
      {
        if (oResult.Value.StartsWith("http://"))
        {
          hashtable2.Add((object) hashtable2.Count.ToString(), (object) new Link(oResult.Value, oResult.Value, oResult));
        }
        else
        {
          if (oResult.Value.StartsWith("./"))
            oResult.Value = oResult.Value.Replace("./", "/");
          if (oResult.Value.StartsWith("/") | oResult.Value.StartsWith("./"))
            hashtable2.Add((object) hashtable2.Count.ToString(), (object) new Link(oResult.Value, str + oResult.Value, oResult));
          else
            hashtable2.Add((object) hashtable2.Count.ToString(), (object) new Link(oResult.Value, str + "/" + oResult.Value, oResult));
        }
      }
    }
    finally
    {
      IEnumerator enumerator;
      if (enumerator is IDisposable)
        (enumerator as IDisposable).Dispose();
    }
    return hashtable2;
  }
}
