// Decompiled with JetBrains decompiler
// Type: Settings
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections;
using System.Windows.Forms;
using System.Windows.Forms.Layout;

public class Settings
{
  private bool CheckObject(object o)
  {
    bool flag = true;
    return o != Globals.G_Counter.txtReqSource && flag != (o == Globals.G_Main.spcBack) && (flag != (o == Globals.G_Scanner.grbMultiDorks) && flag != (o == Globals.G_Dumper.chkHideSetup));
  }

  public Hashtable EnumerateAllControlsOnAForm(Form oForm)
  {
    Hashtable oCollection = new Hashtable();
    try
    {
      foreach (Control control in oForm.Controls)
      {
        if (control != null && !string.IsNullOrEmpty(control.Name))
        {
          if (!oCollection.Contains((object) control.Name))
            oCollection.Add((object) control.Name, (object) control);
          if (control is ToolStrip)
          {
            try
            {
              foreach (ToolStripItem toolStripItem in (ArrangedElementCollection) ((ToolStrip) control).Items)
              {
                if (!oCollection.Contains((object) toolStripItem.Name) & !string.IsNullOrEmpty(toolStripItem.Name))
                {
                  bool flag = true;
                  if (toolStripItem is ToolStripTextBox || flag == toolStripItem is ToolStripComboBox)
                    oCollection.Add((object) toolStripItem.Name, (object) toolStripItem);
                }
              }
            }
            finally
            {
              IEnumerator enumerator;
              if (enumerator is IDisposable)
                (enumerator as IDisposable).Dispose();
            }
          }
          else if (control is SplitContainer)
          {
            this.EnumerateAllControls((Control) ((SplitContainer) control).Panel1, ref oCollection);
            this.EnumerateAllControls((Control) ((SplitContainer) control).Panel2, ref oCollection);
          }
          else if (control.Controls.Count > 0)
            this.EnumerateAllControls(control, ref oCollection);
        }
      }
    }
    finally
    {
      IEnumerator enumerator;
      if (enumerator is IDisposable)
        (enumerator as IDisposable).Dispose();
    }
    return oCollection;
  }

  public void EnumerateAllControls(Control oContainer, ref Hashtable oCollection)
  {
    try
    {
      foreach (Control control in oContainer.Controls)
      {
        if (control != null && !string.IsNullOrEmpty(control.Name))
        {
          if (!oCollection.Contains((object) control.Name))
            oCollection.Add((object) control.Name, (object) control);
          if (control.Controls.Count > 0)
          {
            if (control is SplitContainer)
            {
              this.EnumerateAllControls((Control) ((SplitContainer) control).Panel1, ref oCollection);
              this.EnumerateAllControls((Control) ((SplitContainer) control).Panel2, ref oCollection);
            }
            else
              this.EnumerateAllControls(control, ref oCollection);
          }
        }
      }
    }
    finally
    {
      IEnumerator enumerator;
      if (enumerator is IDisposable)
        (enumerator as IDisposable).Dispose();
    }
  }

  public void LoadSettings(Form oForm, cXML oXML = null, string sName = "")
  {
label_0:
    int num1;
    int num2;
    try
    {
      int num3 = 1;
      Hashtable hashtable;
      if (oForm != null)
      {
label_1:
        num3 = 4;
        hashtable = this.EnumerateAllControlsOnAForm(oForm);
      }
      else
        goto label_42;
label_2:
      num3 = 5;
      if (!string.IsNullOrEmpty(sName))
        goto label_4;
label_3:
      num3 = 6;
      sName = oForm.Name;
label_4:
      ProjectData.ClearProjectError();
      num1 = 1;
label_5:
      num3 = 9;
      if (oXML != null)
        goto label_7;
label_6:
      num3 = 10;
      oXML = Globals.G_XML;
label_7:
      num3 = 12;
      IEnumerator enumerator = oXML.GetAllSettings(sName).Values.GetEnumerator();
label_8:
      XMLTag current;
      if (enumerator.MoveNext())
        current = (XMLTag) enumerator.Current;
      else if (enumerator is IDisposable)
      {
        (enumerator as IDisposable).Dispose();
        goto label_42;
      }
      else
        goto label_42;
label_10:
      num3 = 13;
      if (!hashtable.Contains((object) current.Name))
        goto label_33;
label_11:
      num3 = 14;
      Control control = (Control) hashtable[(object) current.Name];
label_12:
      num3 = 15;
      if (control == null)
        goto label_33;
label_13:
      num3 = 16;
      if (!this.CheckObject((object) control))
        goto label_33;
label_14:
      num3 = 17;
      bool flag = true;
label_15:
      num3 = 20;
      if (flag != control is TextBox)
        goto label_17;
label_16:
      num3 = 21;
      ((TextBox) control).Text = current.Value;
      goto label_33;
label_17:
      num3 = 23;
      if (flag != control is ComboBox)
        goto label_19;
label_18:
      num3 = 24;
      ((ComboBox) control).Text = current.Value;
      goto label_33;
label_19:
      num3 = 26;
      if (flag != control is CheckBox)
        goto label_21;
label_20:
      num3 = 27;
      ((CheckBox) control).Checked = Conversions.ToBoolean(current.Value);
      goto label_33;
label_21:
      num3 = 29;
      if (flag != control is RadioButton)
        goto label_23;
label_22:
      num3 = 30;
      ((RadioButton) control).Checked = Conversions.ToBoolean(current.Value);
      goto label_33;
label_23:
      num3 = 32;
      if (flag != control is NumericUpDown)
        goto label_25;
label_24:
      num3 = 33;
      ((NumericUpDown) control).Value = new Decimal(Conversions.ToInteger(current.Value));
      goto label_33;
label_25:
      num3 = 35;
      if (flag != control is TrackBar)
        goto label_27;
label_26:
      num3 = 36;
      ((TrackBar) control).Value = Conversions.ToInteger(current.Value);
      goto label_33;
label_27:
      num3 = 38;
      if (flag != control is GroupContractable)
        goto label_29;
label_28:
      num3 = 39;
      ((GroupContractable) control).SetCollapsed(Conversions.ToBoolean(current.Value));
      goto label_33;
label_29:
      num3 = 41;
      if (flag != control is TreeView)
        goto label_31;
label_30:
      num3 = 42;
      this.LoadTreeView((TreeView) control, current.Value);
      goto label_33;
label_31:
      num3 = 44;
      if (flag != control is CheckedListBox)
        goto label_33;
label_32:
      num3 = 45;
      this.LoadCheckedListBox((CheckedListBox) control, current.Value);
label_33:
      num3 = 52;
      goto label_8;
label_37:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
            case 53:
              goto label_42;
            case 3:
            case 4:
              goto label_1;
            case 5:
              goto label_2;
            case 6:
              goto label_3;
            case 7:
            case 8:
              goto label_4;
            case 9:
              goto label_5;
            case 10:
              goto label_6;
            case 11:
            case 12:
              goto label_7;
            case 13:
              goto label_10;
            case 14:
              goto label_11;
            case 15:
              goto label_12;
            case 16:
              goto label_13;
            case 17:
              goto label_14;
            case 18:
            case 22:
            case 25:
            case 28:
            case 31:
            case 34:
            case 37:
            case 40:
            case 43:
            case 46:
            case 47:
            case 48:
            case 49:
            case 50:
            case 51:
            case 52:
              goto label_33;
            case 19:
            case 20:
              goto label_15;
            case 21:
              goto label_16;
            case 23:
              goto label_17;
            case 24:
              goto label_18;
            case 26:
              goto label_19;
            case 27:
              goto label_20;
            case 29:
              goto label_21;
            case 30:
              goto label_22;
            case 32:
              goto label_23;
            case 33:
              goto label_24;
            case 35:
              goto label_25;
            case 36:
              goto label_26;
            case 38:
              goto label_27;
            case 39:
              goto label_28;
            case 41:
              goto label_29;
            case 42:
              goto label_30;
            case 44:
              goto label_31;
            case 45:
              goto label_32;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_37;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_42:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public void SaveSettings(Form oForm, cXML oXML = null, string sName = "")
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      if (oForm == null)
        goto label_39;
label_2:
      num3 = 5;
      if (oXML != null)
        goto label_4;
label_3:
      num3 = 6;
      oXML = Globals.G_XML;
label_4:
      num3 = 8;
      if (!string.IsNullOrEmpty(sName))
        goto label_6;
label_5:
      num3 = 9;
      sName = oForm.Name;
label_6:
      num3 = 11;
      IEnumerator enumerator = this.EnumerateAllControlsOnAForm(oForm).Values.GetEnumerator();
label_7:
      Control current;
      if (enumerator.MoveNext())
        current = (Control) enumerator.Current;
      else if (enumerator is IDisposable)
      {
        (enumerator as IDisposable).Dispose();
        goto label_39;
      }
      else
        goto label_39;
label_9:
      num3 = 12;
      if (current == null)
        goto label_30;
label_10:
      num3 = 13;
      if (!this.CheckObject((object) current))
        goto label_30;
label_11:
      num3 = 14;
      bool flag = true;
label_12:
      num3 = 17;
      if (flag != current is TextBox)
        goto label_14;
label_13:
      num3 = 18;
      oXML.SaveSetting(sName, current.Name, ((TextBox) current).Text);
      goto label_30;
label_14:
      num3 = 20;
      if (flag != current is ComboBox)
        goto label_16;
label_15:
      num3 = 21;
      oXML.SaveSetting(sName, current.Name, ((ComboBox) current).Text);
      goto label_30;
label_16:
      num3 = 23;
      if (flag != current is CheckBox)
        goto label_18;
label_17:
      num3 = 24;
      oXML.SaveSetting(sName, current.Name, ((CheckBox) current).Checked.ToString());
      goto label_30;
label_18:
      num3 = 26;
      if (flag != current is RadioButton)
        goto label_20;
label_19:
      num3 = 27;
      oXML.SaveSetting(sName, current.Name, ((RadioButton) current).Checked.ToString());
      goto label_30;
label_20:
      num3 = 29;
      if (flag != current is NumericUpDown)
        goto label_22;
label_21:
      num3 = 30;
      oXML.SaveSetting(sName, current.Name, ((NumericUpDown) current).Value.ToString());
      goto label_30;
label_22:
      num3 = 32;
      if (flag != current is TrackBar)
        goto label_24;
label_23:
      num3 = 33;
      oXML.SaveSetting(sName, current.Name, ((TrackBar) current).Value.ToString());
      goto label_30;
label_24:
      num3 = 35;
      if (flag != current is GroupContractable)
        goto label_26;
label_25:
      num3 = 36;
      oXML.SaveSetting(sName, current.Name, ((GroupContractable) current).HasCollapsed.ToString());
      goto label_30;
label_26:
      num3 = 38;
      if (flag != current is TreeView)
        goto label_28;
label_27:
      num3 = 39;
      this.SaveTreeView(sName, (TreeView) current, oXML);
      goto label_30;
label_28:
      num3 = 41;
      if (flag != current is CheckedListBox)
        goto label_30;
label_29:
      num3 = 42;
      this.SaveCheckedListBox(oForm, (CheckedListBox) current, oXML);
label_30:
      num3 = 48;
      goto label_7;
label_34:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
            case 49:
              goto label_39;
            case 4:
            case 5:
              goto label_2;
            case 6:
              goto label_3;
            case 7:
            case 8:
              goto label_4;
            case 9:
              goto label_5;
            case 10:
            case 11:
              goto label_6;
            case 12:
              goto label_9;
            case 13:
              goto label_10;
            case 14:
              goto label_11;
            case 15:
            case 19:
            case 22:
            case 25:
            case 28:
            case 31:
            case 34:
            case 37:
            case 40:
            case 43:
            case 44:
            case 45:
            case 46:
            case 47:
            case 48:
              goto label_30;
            case 16:
            case 17:
              goto label_12;
            case 18:
              goto label_13;
            case 20:
              goto label_14;
            case 21:
              goto label_15;
            case 23:
              goto label_16;
            case 24:
              goto label_17;
            case 26:
              goto label_18;
            case 27:
              goto label_19;
            case 29:
              goto label_20;
            case 30:
              goto label_21;
            case 32:
              goto label_22;
            case 33:
              goto label_23;
            case 35:
              goto label_24;
            case 36:
              goto label_25;
            case 38:
              goto label_26;
            case 39:
              goto label_27;
            case 41:
              goto label_28;
            case 42:
              goto label_29;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & (uint) num1 > 0U & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_34;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_39:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private void SaveTreeView(string sName, TreeView oTreeView, cXML oXML = null)
  {
    try
    {
      if (oXML == null)
        oXML = Globals.G_XML;
      string str = "";
      try
      {
        foreach (TreeNode node1 in oTreeView.Nodes)
        {
          if (node1.Nodes.Count == 0)
          {
            str = Operators.CompareString(str, "", false) != 0 ? str + "|" + node1.FullPath : node1.FullPath;
          }
          else
          {
            try
            {
              foreach (TreeNode node2 in node1.Nodes)
              {
                if (node2.Nodes.Count == 0)
                {
                  str = Operators.CompareString(str, "", false) != 0 ? str + "|" + node2.FullPath : node2.FullPath;
                }
                else
                {
                  try
                  {
                    foreach (TreeNode node3 in node2.Nodes)
                    {
                      if (node3.Nodes.Count == 0)
                      {
                        str = Operators.CompareString(str, "", false) != 0 ? str + "|" + node3.FullPath : node3.FullPath;
                      }
                      else
                      {
                        try
                        {
                          foreach (TreeNode node4 in node3.Nodes)
                            str = Operators.CompareString(str, "", false) != 0 ? str + "|" + node4.FullPath : node4.FullPath;
                        }
                        finally
                        {
                          IEnumerator enumerator;
                          if (enumerator is IDisposable)
                            (enumerator as IDisposable).Dispose();
                        }
                      }
                      str = str + "\\" + node3.Checked.ToString();
                    }
                  }
                  finally
                  {
                    IEnumerator enumerator;
                    if (enumerator is IDisposable)
                      (enumerator as IDisposable).Dispose();
                  }
                }
              }
            }
            finally
            {
              IEnumerator enumerator;
              if (enumerator is IDisposable)
                (enumerator as IDisposable).Dispose();
            }
          }
        }
      }
      finally
      {
        IEnumerator enumerator;
        if (enumerator is IDisposable)
          (enumerator as IDisposable).Dispose();
      }
      oXML.SaveSetting(sName, oTreeView.Name, str);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  private void LoadTreeView(TreeView oTreeView, string sData, cXML oXML = null)
  {
    try
    {
      if (oXML == null)
        oXML = Globals.G_XML;
      string[] strArray1 = sData.Split('|');
      oTreeView.BeginUpdate();
      oTreeView.Nodes.Clear();
      string[] strArray2 = strArray1;
      int index = 0;
      while (index < strArray2.Length)
      {
        string[] strArray3 = strArray2[index].Split('\\');
        switch (strArray3.Length)
        {
          case 1:
            if (!string.IsNullOrEmpty(strArray3[0]))
            {
              oTreeView.Nodes.Add(strArray3[0], strArray3[0], 0);
              break;
            }
            break;
          case 2:
            TreeNode treeNode1 = oTreeView.Nodes[strArray3[0]] ?? oTreeView.Nodes.Add(strArray3[0], strArray3[0], 0);
            if (treeNode1.Nodes[strArray3[1]] == null)
            {
              treeNode1.Nodes.Add(strArray3[1], strArray3[1], 1).SelectedImageIndex = 1;
              break;
            }
            break;
          default:
            TreeNode treeNode2 = oTreeView.Nodes[strArray3[0]] ?? oTreeView.Nodes.Add(strArray3[0], strArray3[0], 0);
            TreeNode node = treeNode2.Nodes[strArray3[1]];
            TreeNode treeNode3;
            if (node == null)
            {
              treeNode3 = treeNode2.Nodes.Add(strArray3[1], strArray3[1], 1);
              treeNode3.SelectedImageIndex = 1;
            }
            else
              treeNode3 = node;
            if (treeNode3 != null)
            {
              TreeNode treeNode4 = treeNode3.Nodes.Add(strArray3[2], strArray3[2], 2);
              treeNode4.SelectedImageIndex = 2;
              if (strArray3.Length > 3)
              {
                treeNode4.Checked = Conversions.ToBoolean(strArray3[3]);
                break;
              }
              break;
            }
            break;
        }
        checked { ++index; }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    finally
    {
      oTreeView.EndUpdate();
    }
  }

  private void SaveCheckedListBox(Form oForm, CheckedListBox oList, cXML oXML = null)
  {
    try
    {
      if (oXML == null)
        oXML = Globals.G_XML;
      string sValue = "";
      int count = oList.Items.Count;
      int index = 0;
      while (index <= count)
      {
        bool itemChecked;
        if (index == 0)
        {
          string str1 = oList.Items[index].ToString();
          itemChecked = oList.GetItemChecked(index);
          string str2 = itemChecked.ToString();
          sValue = str1 + "§" + str2;
        }
        else
        {
          string[] strArray1 = new string[5]
          {
            sValue,
            "|",
            oList.Items[index].ToString(),
            "§",
            null
          };
          string[] strArray2 = strArray1;
          itemChecked = oList.GetItemChecked(index);
          string str = itemChecked.ToString();
          strArray2[4] = str;
          sValue = string.Concat(strArray1);
        }
        checked { ++index; }
      }
      oXML.SaveSetting(oForm.Name, oList.Name, sValue);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
  }

  private void LoadCheckedListBox(CheckedListBox oList, string sData, cXML oXML = null)
  {
    try
    {
      if (oXML == null)
        oXML = Globals.G_XML;
      string[] strArray1 = sData.Split('|');
      oList.BeginUpdate();
      int length = strArray1.Length;
      int index = 0;
      while (index <= length && checked (oList.Items.Count - 1) >= index)
      {
        string[] strArray2 = Strings.Split(strArray1[index], "§");
        if (strArray2.Length == 2 && strArray2[0].Equals(oList.GetItemChecked(index).ToString()))
        {
          bool result;
          bool.TryParse(strArray2[1], out result);
          oList.SetItemChecked(index, result);
        }
        checked { ++index; }
      }
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      ProjectData.ClearProjectError();
    }
    finally
    {
      oList.EndUpdate();
    }
  }

  public void SaveToFile() => Globals.G_XML.SaveToFile();

  public Settings() => Globals.G_XML = new cXML(Globals.XML_PATH);

  ~Settings() => base.Finalize();
}
