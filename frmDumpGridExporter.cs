// Decompiled with JetBrains decompiler
// Type: frmDumpGridExporter
// Assembly: SQLi Dumper, Version=8.5.0.0, Culture=neutral, PublicKeyToken=null
// MVID: FFDD07D3-5737-4188-BACA-DE2D004C7CCF
// Assembly location: C:\Users\cole\Desktop\SQLi Dumper v8.5 [VeryClean]\SQLi v.8.5 VeryClean by Stephanny.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Runtime.CompilerServices;
using System.Threading;
using System.Web;
using System.Windows.Forms;

[DesignerGenerated]
public class frmDumpGridExporter : Form
{
  private IContainer components;
  [AccessedThroughProperty("OK_Button")]
  private Button _OK_Button;
  [AccessedThroughProperty("Cancel_Button")]
  private Button _Cancel_Button;
  [AccessedThroughProperty("GroupBox1")]
  private GroupBox _GroupBox1;
  [AccessedThroughProperty("rdbOpt1")]
  private RadioButton _rdbOpt1;
  [AccessedThroughProperty("rdbOpt2")]
  private RadioButton _rdbOpt2;
  [AccessedThroughProperty("txtDeli")]
  private TextBox _txtDeli;
  [AccessedThroughProperty("stsMain")]
  private StatusStrip _stsMain;
  [AccessedThroughProperty("lblStatus")]
  private ToolStripStatusLabel _lblStatus;
  [AccessedThroughProperty("prbStatus")]
  private ProgressBarExt _prbStatus;
  [AccessedThroughProperty("bwSave")]
  private BackgroundWorker _bwSave;
  [AccessedThroughProperty("GroupBox2")]
  private GroupBox _GroupBox2;
  [AccessedThroughProperty("lsColumns")]
  private CheckedListBox _lsColumns;
  [AccessedThroughProperty("mnuColumns")]
  private ContextMenuStrip _mnuColumns;
  [AccessedThroughProperty("mmnCheck")]
  private ToolStripMenuItem _mmnCheck;
  [AccessedThroughProperty("mmnUnCheck")]
  private ToolStripMenuItem _mmnUnCheck;
  [AccessedThroughProperty("GroupBox3")]
  private GroupBox _GroupBox3;
  [AccessedThroughProperty("txtReplaceLine")]
  private TextBox _txtReplaceLine;
  [AccessedThroughProperty("chkReplaceLines")]
  private CheckBox _chkReplaceLines;
  [AccessedThroughProperty("mnuMoveUP")]
  private ToolStripMenuItem _mnuMoveUP;
  [AccessedThroughProperty("mnuMoveDown")]
  private ToolStripMenuItem _mnuMoveDown;
  [AccessedThroughProperty("ToolStripSeparator1")]
  private ToolStripSeparator _ToolStripSeparator1;
  [AccessedThroughProperty("GroupBox4")]
  private GroupBox _GroupBox4;
  [AccessedThroughProperty("rdpType_2")]
  private RadioButton _rdpType_2;
  [AccessedThroughProperty("rdpType_1")]
  private RadioButton _rdpType_1;
  [AccessedThroughProperty("rdpType_3")]
  private RadioButton _rdpType_3;
  private DataGridView __Grid;
  private string __FileName;
  private string __URL;
  private const string BTN_START = "&Start..";
  private const string BTN_CANCEL = "&Cancel..";
  private const int WAIT_WRITE_DUMPING = 20;
  private string __LastPath;
  private bool __Working;
  private Dictionary<string, int> __Columns;
  private bool __ReplaceNewLine;
  private string __ReplaceString;
  private string __SplitComma;
  private frmDumpGridExporter.enFileTytpe __FileTytpe;

  [DebuggerNonUserCode]
  protected override void Dispose(bool disposing)
  {
    try
    {
      if (!disposing || this.components == null)
        return;
      this.components.Dispose();
    }
    finally
    {
      base.Dispose(disposing);
    }
  }

  [DebuggerStepThrough]
  private void InitializeComponent()
  {
    this.components = (IContainer) new System.ComponentModel.Container();
    this.OK_Button = new Button();
    this.Cancel_Button = new Button();
    this.GroupBox1 = new GroupBox();
    this.txtDeli = new TextBox();
    this.rdbOpt2 = new RadioButton();
    this.rdbOpt1 = new RadioButton();
    this.stsMain = new StatusStrip();
    this.lblStatus = new ToolStripStatusLabel();
    this.bwSave = new BackgroundWorker();
    this.GroupBox2 = new GroupBox();
    this.lsColumns = new CheckedListBox();
    this.mnuColumns = new ContextMenuStrip(this.components);
    this.mnuMoveUP = new ToolStripMenuItem();
    this.mnuMoveDown = new ToolStripMenuItem();
    this.ToolStripSeparator1 = new ToolStripSeparator();
    this.mmnCheck = new ToolStripMenuItem();
    this.mmnUnCheck = new ToolStripMenuItem();
    this.GroupBox3 = new GroupBox();
    this.chkReplaceLines = new CheckBox();
    this.txtReplaceLine = new TextBox();
    this.GroupBox4 = new GroupBox();
    this.rdpType_3 = new RadioButton();
    this.rdpType_2 = new RadioButton();
    this.rdpType_1 = new RadioButton();
    this.prbStatus = new ProgressBarExt();
    this.GroupBox1.SuspendLayout();
    this.stsMain.SuspendLayout();
    this.GroupBox2.SuspendLayout();
    this.mnuColumns.SuspendLayout();
    this.GroupBox3.SuspendLayout();
    this.GroupBox4.SuspendLayout();
    this.SuspendLayout();
    this.OK_Button.Anchor = AnchorStyles.Bottom | AnchorStyles.Left;
    Button okButton1 = this.OK_Button;
    Point point1 = new Point(175, 334);
    Point point2 = point1;
    okButton1.Location = point2;
    this.OK_Button.Name = "OK_Button";
    Button okButton2 = this.OK_Button;
    Size size1 = new Size(67, 23);
    Size size2 = size1;
    okButton2.Size = size2;
    this.OK_Button.TabIndex = 3;
    this.OK_Button.Text = "OK";
    this.Cancel_Button.Anchor = AnchorStyles.Bottom | AnchorStyles.Left;
    this.Cancel_Button.DialogResult = DialogResult.Cancel;
    Button cancelButton1 = this.Cancel_Button;
    point1 = new Point(175, 357);
    Point point3 = point1;
    cancelButton1.Location = point3;
    this.Cancel_Button.Name = "Cancel_Button";
    Button cancelButton2 = this.Cancel_Button;
    size1 = new Size(67, 23);
    Size size3 = size1;
    cancelButton2.Size = size3;
    this.Cancel_Button.TabIndex = 4;
    this.Cancel_Button.Text = "Exit";
    this.GroupBox1.Controls.Add((Control) this.txtDeli);
    this.GroupBox1.Controls.Add((Control) this.rdbOpt2);
    this.GroupBox1.Controls.Add((Control) this.rdbOpt1);
    GroupBox groupBox1_1 = this.GroupBox1;
    point1 = new Point(4, 46);
    Point point4 = point1;
    groupBox1_1.Location = point4;
    this.GroupBox1.Name = "GroupBox1";
    GroupBox groupBox1_2 = this.GroupBox1;
    size1 = new Size(238, 69);
    Size size4 = size1;
    groupBox1_2.Size = size4;
    this.GroupBox1.TabIndex = 0;
    this.GroupBox1.TabStop = false;
    this.GroupBox1.Text = "Delimiter";
    this.txtDeli.Enabled = false;
    this.txtDeli.Font = new Font("Microsoft Sans Serif", 8.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
    TextBox txtDeli1 = this.txtDeli;
    point1 = new Point(72, 39);
    Point point5 = point1;
    txtDeli1.Location = point5;
    this.txtDeli.Name = "txtDeli";
    TextBox txtDeli2 = this.txtDeli;
    size1 = new Size(159, 20);
    Size size5 = size1;
    txtDeli2.Size = size5;
    this.txtDeli.TabIndex = 2;
    this.txtDeli.Text = ":";
    this.rdbOpt2.AutoSize = true;
    RadioButton rdbOpt2_1 = this.rdbOpt2;
    point1 = new Point(6, 42);
    Point point6 = point1;
    rdbOpt2_1.Location = point6;
    this.rdbOpt2.Name = "rdbOpt2";
    RadioButton rdbOpt2_2 = this.rdbOpt2;
    size1 = new Size(60, 17);
    Size size6 = size1;
    rdbOpt2_2.Size = size6;
    this.rdbOpt2.TabIndex = 1;
    this.rdbOpt2.Text = "Custom";
    this.rdbOpt2.UseVisualStyleBackColor = true;
    this.rdbOpt1.AutoSize = true;
    this.rdbOpt1.Checked = true;
    RadioButton rdbOpt1_1 = this.rdbOpt1;
    point1 = new Point(6, 19);
    Point point7 = point1;
    rdbOpt1_1.Location = point7;
    this.rdbOpt1.Name = "rdbOpt1";
    RadioButton rdbOpt1_2 = this.rdbOpt1;
    size1 = new Size(69, 17);
    Size size7 = size1;
    rdbOpt1_2.Size = size7;
    this.rdbOpt1.TabIndex = 0;
    this.rdbOpt1.TabStop = true;
    this.rdbOpt1.Text = "Char Tab";
    this.rdbOpt1.UseVisualStyleBackColor = true;
    this.stsMain.Items.AddRange(new ToolStripItem[1]
    {
      (ToolStripItem) this.lblStatus
    });
    StatusStrip stsMain1 = this.stsMain;
    point1 = new Point(0, 383);
    Point point8 = point1;
    stsMain1.Location = point8;
    this.stsMain.Name = "stsMain";
    this.stsMain.RenderMode = ToolStripRenderMode.Professional;
    StatusStrip stsMain2 = this.stsMain;
    size1 = new Size(247, 22);
    Size size8 = size1;
    stsMain2.Size = size8;
    this.stsMain.SizingGrip = false;
    this.stsMain.TabIndex = 3;
    this.stsMain.Text = "StatusStrip1";
    this.lblStatus.AutoToolTip = true;
    this.lblStatus.Name = "lblStatus";
    ToolStripStatusLabel lblStatus = this.lblStatus;
    size1 = new Size(232, 17);
    Size size9 = size1;
    lblStatus.Size = size9;
    this.lblStatus.Spring = true;
    this.lblStatus.Text = "Ready";
    this.lblStatus.TextAlign = ContentAlignment.MiddleLeft;
    this.bwSave.WorkerReportsProgress = true;
    this.bwSave.WorkerSupportsCancellation = true;
    this.GroupBox2.Anchor = AnchorStyles.Top | AnchorStyles.Bottom | AnchorStyles.Left;
    this.GroupBox2.Controls.Add((Control) this.lsColumns);
    GroupBox groupBox2_1 = this.GroupBox2;
    point1 = new Point(5, 115);
    Point point9 = point1;
    groupBox2_1.Location = point9;
    this.GroupBox2.Name = "GroupBox2";
    GroupBox groupBox2_2 = this.GroupBox2;
    size1 = new Size(237, 178);
    Size size10 = size1;
    groupBox2_2.Size = size10;
    this.GroupBox2.TabIndex = 1;
    this.GroupBox2.TabStop = false;
    this.GroupBox2.Text = "Columns";
    this.lsColumns.ContextMenuStrip = this.mnuColumns;
    this.lsColumns.Dock = DockStyle.Fill;
    this.lsColumns.FormattingEnabled = true;
    CheckedListBox lsColumns1 = this.lsColumns;
    point1 = new Point(3, 16);
    Point point10 = point1;
    lsColumns1.Location = point10;
    this.lsColumns.Name = "lsColumns";
    CheckedListBox lsColumns2 = this.lsColumns;
    size1 = new Size(231, 159);
    Size size11 = size1;
    lsColumns2.Size = size11;
    this.lsColumns.TabIndex = 0;
    this.mnuColumns.Items.AddRange(new ToolStripItem[5]
    {
      (ToolStripItem) this.mnuMoveUP,
      (ToolStripItem) this.mnuMoveDown,
      (ToolStripItem) this.ToolStripSeparator1,
      (ToolStripItem) this.mmnCheck,
      (ToolStripItem) this.mmnUnCheck
    });
    this.mnuColumns.Name = "mnuColumns";
    this.mnuColumns.ShowImageMargin = false;
    ContextMenuStrip mnuColumns = this.mnuColumns;
    size1 = new Size(115, 98);
    Size size12 = size1;
    mnuColumns.Size = size12;
    this.mnuMoveUP.Name = "mnuMoveUP";
    ToolStripMenuItem mnuMoveUp = this.mnuMoveUP;
    size1 = new Size(114, 22);
    Size size13 = size1;
    mnuMoveUp.Size = size13;
    this.mnuMoveUP.Text = "Move UP";
    this.mnuMoveDown.Name = "mnuMoveDown";
    ToolStripMenuItem mnuMoveDown = this.mnuMoveDown;
    size1 = new Size(114, 22);
    Size size14 = size1;
    mnuMoveDown.Size = size14;
    this.mnuMoveDown.Text = "Move Down";
    this.ToolStripSeparator1.Name = "ToolStripSeparator1";
    ToolStripSeparator toolStripSeparator1 = this.ToolStripSeparator1;
    size1 = new Size(111, 6);
    Size size15 = size1;
    toolStripSeparator1.Size = size15;
    this.mmnCheck.Name = "mmnCheck";
    ToolStripMenuItem mmnCheck = this.mmnCheck;
    size1 = new Size(114, 22);
    Size size16 = size1;
    mmnCheck.Size = size16;
    this.mmnCheck.Text = "Check All";
    this.mmnUnCheck.Name = "mmnUnCheck";
    ToolStripMenuItem mmnUnCheck = this.mmnUnCheck;
    size1 = new Size(114, 22);
    Size size17 = size1;
    mmnUnCheck.Size = size17;
    this.mmnUnCheck.Text = "UnCheck All";
    this.GroupBox3.Anchor = AnchorStyles.Bottom | AnchorStyles.Left;
    this.GroupBox3.Controls.Add((Control) this.chkReplaceLines);
    this.GroupBox3.Controls.Add((Control) this.txtReplaceLine);
    GroupBox groupBox3_1 = this.GroupBox3;
    point1 = new Point(5, 294);
    Point point11 = point1;
    groupBox3_1.Location = point11;
    this.GroupBox3.Name = "GroupBox3";
    GroupBox groupBox3_2 = this.GroupBox3;
    size1 = new Size(237, 37);
    Size size18 = size1;
    groupBox3_2.Size = size18;
    this.GroupBox3.TabIndex = 5;
    this.GroupBox3.TabStop = false;
    this.chkReplaceLines.Anchor = AnchorStyles.Top | AnchorStyles.Right;
    this.chkReplaceLines.AutoSize = true;
    this.chkReplaceLines.CheckAlign = ContentAlignment.MiddleRight;
    this.chkReplaceLines.Checked = true;
    this.chkReplaceLines.CheckState = CheckState.Checked;
    CheckBox chkReplaceLines1 = this.chkReplaceLines;
    point1 = new Point(33, 14);
    Point point12 = point1;
    chkReplaceLines1.Location = point12;
    this.chkReplaceLines.Name = "chkReplaceLines";
    CheckBox chkReplaceLines2 = this.chkReplaceLines;
    size1 = new Size(94, 17);
    Size size19 = size1;
    chkReplaceLines2.Size = size19;
    this.chkReplaceLines.TabIndex = 3;
    this.chkReplaceLines.Text = "Replace Lines";
    this.chkReplaceLines.UseVisualStyleBackColor = true;
    this.txtReplaceLine.Anchor = AnchorStyles.Top | AnchorStyles.Right;
    this.txtReplaceLine.Enabled = false;
    this.txtReplaceLine.Font = new Font("Microsoft Sans Serif", 8.25f, FontStyle.Bold, GraphicsUnit.Point, (byte) 0);
    TextBox txtReplaceLine1 = this.txtReplaceLine;
    point1 = new Point(133, 11);
    Point point13 = point1;
    txtReplaceLine1.Location = point13;
    this.txtReplaceLine.Name = "txtReplaceLine";
    TextBox txtReplaceLine2 = this.txtReplaceLine;
    size1 = new Size(98, 20);
    Size size20 = size1;
    txtReplaceLine2.Size = size20;
    this.txtReplaceLine.TabIndex = 2;
    this.txtReplaceLine.Text = "{NewLine}";
    this.GroupBox4.Controls.Add((Control) this.rdpType_3);
    this.GroupBox4.Controls.Add((Control) this.rdpType_2);
    this.GroupBox4.Controls.Add((Control) this.rdpType_1);
    GroupBox groupBox4_1 = this.GroupBox4;
    point1 = new Point(4, 3);
    Point point14 = point1;
    groupBox4_1.Location = point14;
    this.GroupBox4.Name = "GroupBox4";
    GroupBox groupBox4_2 = this.GroupBox4;
    size1 = new Size(238, 43);
    Size size21 = size1;
    groupBox4_2.Size = size21;
    this.GroupBox4.TabIndex = 6;
    this.GroupBox4.TabStop = false;
    this.GroupBox4.Text = "File Type";
    this.rdpType_3.AutoSize = true;
    RadioButton rdpType3_1 = this.rdpType_3;
    point1 = new Point(140, 19);
    Point point15 = point1;
    rdpType3_1.Location = point15;
    this.rdpType_3.Name = "rdpType_3";
    RadioButton rdpType3_2 = this.rdpType_3;
    size1 = new Size(47, 17);
    Size size22 = size1;
    rdpType3_2.Size = size22;
    this.rdpType_3.TabIndex = 2;
    this.rdpType_3.Text = "XML";
    this.rdpType_3.UseVisualStyleBackColor = true;
    this.rdpType_2.AutoSize = true;
    RadioButton rdpType2_1 = this.rdpType_2;
    point1 = new Point(80, 19);
    Point point16 = point1;
    rdpType2_1.Location = point16;
    this.rdpType_2.Name = "rdpType_2";
    RadioButton rdpType2_2 = this.rdpType_2;
    size1 = new Size(55, 17);
    Size size23 = size1;
    rdpType2_2.Size = size23;
    this.rdpType_2.TabIndex = 1;
    this.rdpType_2.Text = "HTML";
    this.rdpType_2.UseVisualStyleBackColor = true;
    this.rdpType_1.AutoSize = true;
    this.rdpType_1.Checked = true;
    RadioButton rdpType1_1 = this.rdpType_1;
    point1 = new Point(6, 19);
    Point point17 = point1;
    rdpType1_1.Location = point17;
    this.rdpType_1.Name = "rdpType_1";
    RadioButton rdpType1_2 = this.rdpType_1;
    size1 = new Size(69, 17);
    Size size24 = size1;
    rdpType1_2.Size = size24;
    this.rdpType_1.TabIndex = 0;
    this.rdpType_1.TabStop = true;
    this.rdpType_1.Text = "PlainText";
    this.rdpType_1.UseVisualStyleBackColor = true;
    this.prbStatus.Anchor = AnchorStyles.Bottom | AnchorStyles.Left;
    ProgressBarExt prbStatus1 = this.prbStatus;
    point1 = new Point(4, 334);
    Point point18 = point1;
    prbStatus1.Location = point18;
    this.prbStatus.Name = "prbStatus";
    this.prbStatus.OverlayTextColor = Color.Black;
    this.prbStatus.Percentage = 0.0;
    this.prbStatus.PercentageAlign = ContentAlignment.MiddleCenter;
    ProgressBarExt prbStatus2 = this.prbStatus;
    size1 = new Size(168, 45);
    Size size25 = size1;
    prbStatus2.Size = size25;
    this.prbStatus.Style = ProgressBarStyle.Continuous;
    this.prbStatus.TabIndex = 4;
    this.prbStatus.TextColor = Color.DimGray;
    this.prbStatus.Visible = false;
    this.AcceptButton = (IButtonControl) this.OK_Button;
    this.AutoScaleDimensions = new SizeF(6f, 13f);
    this.AutoScaleMode = AutoScaleMode.Font;
    this.CancelButton = (IButtonControl) this.Cancel_Button;
    size1 = new Size(247, 405);
    this.ClientSize = size1;
    this.ControlBox = false;
    this.Controls.Add((Control) this.GroupBox4);
    this.Controls.Add((Control) this.GroupBox3);
    this.Controls.Add((Control) this.GroupBox2);
    this.Controls.Add((Control) this.OK_Button);
    this.Controls.Add((Control) this.prbStatus);
    this.Controls.Add((Control) this.Cancel_Button);
    this.Controls.Add((Control) this.stsMain);
    this.Controls.Add((Control) this.GroupBox1);
    this.FormBorderStyle = FormBorderStyle.FixedToolWindow;
    this.MaximizeBox = false;
    this.MinimizeBox = false;
    this.Name = nameof (frmDumpGridExporter);
    this.ShowInTaskbar = false;
    this.StartPosition = FormStartPosition.CenterParent;
    this.Text = "Data Exporter";
    this.GroupBox1.ResumeLayout(false);
    this.GroupBox1.PerformLayout();
    this.stsMain.ResumeLayout(false);
    this.stsMain.PerformLayout();
    this.GroupBox2.ResumeLayout(false);
    this.mnuColumns.ResumeLayout(false);
    this.GroupBox3.ResumeLayout(false);
    this.GroupBox3.PerformLayout();
    this.GroupBox4.ResumeLayout(false);
    this.GroupBox4.PerformLayout();
    this.ResumeLayout(false);
    this.PerformLayout();
  }

  internal virtual Button OK_Button
  {
    get => this._OK_Button;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.OK_Button_Click);
      if (this._OK_Button != null)
        this._OK_Button.Click -= eventHandler;
      this._OK_Button = value;
      if (this._OK_Button == null)
        return;
      this._OK_Button.Click += eventHandler;
    }
  }

  internal virtual Button Cancel_Button
  {
    get => this._Cancel_Button;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.Cancel_Button_Click);
      if (this._Cancel_Button != null)
        this._Cancel_Button.Click -= eventHandler;
      this._Cancel_Button = value;
      if (this._Cancel_Button == null)
        return;
      this._Cancel_Button.Click += eventHandler;
    }
  }

  internal virtual GroupBox GroupBox1
  {
    get => this._GroupBox1;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._GroupBox1 = value;
  }

  internal virtual RadioButton rdbOpt1
  {
    get => this._rdbOpt1;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler1 = new EventHandler(this.rdbOpt1_CheckedChanged);
      EventHandler eventHandler2 = new EventHandler(this.rdbOpt1_CheckedChanged);
      if (this._rdbOpt1 != null)
      {
        this._rdbOpt1.CheckedChanged -= eventHandler1;
        this._rdbOpt1.CheckedChanged -= eventHandler2;
      }
      this._rdbOpt1 = value;
      if (this._rdbOpt1 == null)
        return;
      this._rdbOpt1.CheckedChanged += eventHandler1;
      this._rdbOpt1.CheckedChanged += eventHandler2;
    }
  }

  internal virtual RadioButton rdbOpt2
  {
    get => this._rdbOpt2;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._rdbOpt2 = value;
  }

  internal virtual TextBox txtDeli
  {
    get => this._txtDeli;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._txtDeli = value;
  }

  internal virtual StatusStrip stsMain
  {
    get => this._stsMain;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._stsMain = value;
  }

  internal virtual ToolStripStatusLabel lblStatus
  {
    get => this._lblStatus;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._lblStatus = value;
  }

  internal virtual ProgressBarExt prbStatus
  {
    get => this._prbStatus;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._prbStatus = value;
  }

  internal virtual BackgroundWorker bwSave
  {
    get => this._bwSave;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      RunWorkerCompletedEventHandler completedEventHandler = new RunWorkerCompletedEventHandler(this.bwSave_RunWorkerCompleted);
      ProgressChangedEventHandler changedEventHandler = new ProgressChangedEventHandler(this.bwSave_ProgressChanged);
      DoWorkEventHandler workEventHandler = new DoWorkEventHandler(this.bwSave_DoWork);
      if (this._bwSave != null)
      {
        this._bwSave.RunWorkerCompleted -= completedEventHandler;
        this._bwSave.ProgressChanged -= changedEventHandler;
        this._bwSave.DoWork -= workEventHandler;
      }
      this._bwSave = value;
      if (this._bwSave == null)
        return;
      this._bwSave.RunWorkerCompleted += completedEventHandler;
      this._bwSave.ProgressChanged += changedEventHandler;
      this._bwSave.DoWork += workEventHandler;
    }
  }

  internal virtual GroupBox GroupBox2
  {
    get => this._GroupBox2;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._GroupBox2 = value;
  }

  internal virtual CheckedListBox lsColumns
  {
    get => this._lsColumns;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._lsColumns = value;
  }

  internal virtual ContextMenuStrip mnuColumns
  {
    get => this._mnuColumns;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      CancelEventHandler cancelEventHandler = new CancelEventHandler(this.mnuColumns_Opening);
      if (this._mnuColumns != null)
        this._mnuColumns.Opening -= cancelEventHandler;
      this._mnuColumns = value;
      if (this._mnuColumns == null)
        return;
      this._mnuColumns.Opening += cancelEventHandler;
    }
  }

  internal virtual ToolStripMenuItem mmnCheck
  {
    get => this._mmnCheck;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mmnCheck_Click);
      if (this._mmnCheck != null)
        this._mmnCheck.Click -= eventHandler;
      this._mmnCheck = value;
      if (this._mmnCheck == null)
        return;
      this._mmnCheck.Click += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mmnUnCheck
  {
    get => this._mmnUnCheck;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mmnCheck_Click);
      if (this._mmnUnCheck != null)
        this._mmnUnCheck.Click -= eventHandler;
      this._mmnUnCheck = value;
      if (this._mmnUnCheck == null)
        return;
      this._mmnUnCheck.Click += eventHandler;
    }
  }

  internal virtual GroupBox GroupBox3
  {
    get => this._GroupBox3;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._GroupBox3 = value;
  }

  internal virtual TextBox txtReplaceLine
  {
    get => this._txtReplaceLine;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._txtReplaceLine = value;
  }

  internal virtual CheckBox chkReplaceLines
  {
    get => this._chkReplaceLines;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.chkReplaceLines_CheckedChanged);
      if (this._chkReplaceLines != null)
        this._chkReplaceLines.CheckedChanged -= eventHandler;
      this._chkReplaceLines = value;
      if (this._chkReplaceLines == null)
        return;
      this._chkReplaceLines.CheckedChanged += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuMoveUP
  {
    get => this._mnuMoveUP;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mnuMove_Click);
      if (this._mnuMoveUP != null)
        this._mnuMoveUP.Click -= eventHandler;
      this._mnuMoveUP = value;
      if (this._mnuMoveUP == null)
        return;
      this._mnuMoveUP.Click += eventHandler;
    }
  }

  internal virtual ToolStripMenuItem mnuMoveDown
  {
    get => this._mnuMoveDown;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.mnuMove_Click);
      if (this._mnuMoveDown != null)
        this._mnuMoveDown.Click -= eventHandler;
      this._mnuMoveDown = value;
      if (this._mnuMoveDown == null)
        return;
      this._mnuMoveDown.Click += eventHandler;
    }
  }

  internal virtual ToolStripSeparator ToolStripSeparator1
  {
    get => this._ToolStripSeparator1;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._ToolStripSeparator1 = value;
  }

  internal virtual GroupBox GroupBox4
  {
    get => this._GroupBox4;
    [MethodImpl(MethodImplOptions.Synchronized)] set => this._GroupBox4 = value;
  }

  internal virtual RadioButton rdpType_2
  {
    get => this._rdpType_2;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.rdpType_CheckedChanged);
      if (this._rdpType_2 != null)
        this._rdpType_2.CheckedChanged -= eventHandler;
      this._rdpType_2 = value;
      if (this._rdpType_2 == null)
        return;
      this._rdpType_2.CheckedChanged += eventHandler;
    }
  }

  internal virtual RadioButton rdpType_1
  {
    get => this._rdpType_1;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.rdpType_CheckedChanged);
      if (this._rdpType_1 != null)
        this._rdpType_1.CheckedChanged -= eventHandler;
      this._rdpType_1 = value;
      if (this._rdpType_1 == null)
        return;
      this._rdpType_1.CheckedChanged += eventHandler;
    }
  }

  internal virtual RadioButton rdpType_3
  {
    get => this._rdpType_3;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(this.rdpType_CheckedChanged);
      if (this._rdpType_3 != null)
        this._rdpType_3.CheckedChanged -= eventHandler;
      this._rdpType_3 = value;
      if (this._rdpType_3 == null)
        return;
      this._rdpType_3.CheckedChanged += eventHandler;
    }
  }

  public frmDumpGridExporter(DataGridView g, string dFileName, string sURL)
  {
    this.FormClosing += new FormClosingEventHandler(this.frmDumpGridExporter_FormClosing);
    this.Load += new EventHandler(this.frmDumpGridExporter_Load);
    this.InitializeComponent();
    this.__Grid = g;
    this.__FileName = dFileName;
    this.__URL = sURL;
  }

  private DataGridViewRow GetDataGridViewRow(int Index)
  {
    if (!this.__Grid.InvokeRequired)
      return this.__Grid.Rows[Index];
    return (DataGridViewRow) this.__Grid.Invoke((Delegate) new frmDumpGridExporter.GetROW(this.GetDataGridViewRow), (object) Index);
  }

  private int RowCount() => this.__Grid.InvokeRequired ? Conversions.ToInteger(this.__Grid.Invoke((Delegate) new frmDumpGridExporter.GetCount(this.RowCount))) : this.__Grid.RowCount;

  private void bwSave_DoWork(object sender, DoWorkEventArgs e)
  {
    StreamWriter streamWriter = (StreamWriter) null;
    try
    {
      this.__Working = true;
      streamWriter = new StreamWriter(this.__FileName);
      try
      {
        foreach (KeyValuePair<string, int> column in this.__Columns)
        {
          bool flag;
          switch (this.__FileTytpe)
          {
            case frmDumpGridExporter.enFileTytpe.TXT:
              if (flag)
              {
                streamWriter.WriteLine(this.__URL);
                streamWriter.Write(this.__SplitComma + column.Key);
                break;
              }
              streamWriter.Write(column.Key);
              break;
            case frmDumpGridExporter.enFileTytpe.HTML:
              if (!flag)
              {
                streamWriter.WriteLine("<html>");
                streamWriter.WriteLine("<title>" + HttpUtility.HtmlEncode(this.__URL) + "</title>");
                streamWriter.WriteLine("<body>");
                streamWriter.WriteLine("<table border>");
                streamWriter.WriteLine("<tr>");
              }
              streamWriter.WriteLine("<td>" + HttpUtility.HtmlEncode(column.Key) + "</td>");
              break;
            case frmDumpGridExporter.enFileTytpe.XML:
              if (!flag)
              {
                streamWriter.WriteLine("<DocumentElement>");
                streamWriter.WriteLine("<URL>" + HttpUtility.HtmlEncode(this.__URL) + "</URL>");
                break;
              }
              break;
          }
          flag = true;
        }
      }
      finally
      {
        Dictionary<string, int>.Enumerator enumerator;
        enumerator.Dispose();
      }
      switch (this.__FileTytpe)
      {
        case frmDumpGridExporter.enFileTytpe.TXT:
          streamWriter.WriteLine();
          break;
        case frmDumpGridExporter.enFileTytpe.HTML:
          streamWriter.WriteLine("</tr>");
          break;
      }
label_50:
      int Index;
      int percentProgress;
      do
      {
        do
        {
          percentProgress = checked ((int) Math.Round(Math.Round(unchecked ((double) checked (Index + 1 * 100) / (double) this.RowCount()))));
          this.bwSave.ReportProgress(percentProgress, (object) ("Rows " + Strings.FormatNumber((object) Index, 0) + " of " + Strings.FormatNumber((object) this.RowCount(), 0)));
          if (!this.bwSave.CancellationPending)
          {
            DataGridViewRow dataGridViewRow = this.GetDataGridViewRow(Index);
            bool flag = false;
            try
            {
              foreach (KeyValuePair<string, int> column in this.__Columns)
              {
                string s = Conversions.ToString(dataGridViewRow.Cells[column.Value].Value);
                if (this.__FileTytpe == frmDumpGridExporter.enFileTytpe.TXT && this.__ReplaceNewLine)
                {
                  if (s.IndexOf("\n") > 0)
                    s = s.Replace("\n", this.__ReplaceString);
                  if (s.IndexOf("\v\n") > 0)
                    s = s.Replace("\v\n", this.__ReplaceString);
                  if (s.IndexOf("\r") > 0)
                    s = s.Replace("\r", this.__ReplaceString);
                  if (s.IndexOf("\r\n") > 0)
                    s = s.Replace("\r\n", this.__ReplaceString);
                }
                switch (this.__FileTytpe)
                {
                  case frmDumpGridExporter.enFileTytpe.TXT:
                    if (flag)
                    {
                      streamWriter.Write(this.__SplitComma + s);
                      break;
                    }
                    streamWriter.Write(s);
                    break;
                  case frmDumpGridExporter.enFileTytpe.HTML:
                    if (!flag)
                      streamWriter.WriteLine("<tr>");
                    streamWriter.WriteLine("<td>" + HttpUtility.HtmlEncode(s) + "</td>");
                    break;
                  case frmDumpGridExporter.enFileTytpe.XML:
                    if (!flag)
                      streamWriter.WriteLine("<item>");
                    string str = HttpUtility.HtmlEncode(column.Key);
                    streamWriter.WriteLine("<" + str + ">" + HttpUtility.HtmlEncode(s) + "</" + str + ">");
                    break;
                }
                flag = true;
              }
            }
            finally
            {
              Dictionary<string, int>.Enumerator enumerator;
              enumerator.Dispose();
            }
            switch (this.__FileTytpe)
            {
              case frmDumpGridExporter.enFileTytpe.TXT:
                streamWriter.WriteLine();
                break;
              case frmDumpGridExporter.enFileTytpe.HTML:
                streamWriter.WriteLine("</tr>");
                break;
              case frmDumpGridExporter.enFileTytpe.XML:
                streamWriter.WriteLine("</item>");
                break;
            }
            checked { ++Index; }
            if (Globals.G_Dumper.RunningWorker)
              goto label_47;
          }
          else
            break;
        }
        while (Index < checked (this.RowCount() - 1));
        goto label_51;
label_47:;
      }
      while (Index < checked (this.RowCount() - 1));
      do
      {
        this.bwSave.ReportProgress(percentProgress, (object) ("Waiting.. Rows " + Strings.FormatNumber((object) Index, 0) + " of " + Strings.FormatNumber((object) this.RowCount(), 0)));
        Thread.Sleep(200);
      }
      while (Globals.G_Dumper.RunningWorker && (checked (this.RowCount() - 1 - Index) <= 20 && !this.bwSave.CancellationPending));
      goto label_50;
label_51:
      switch (this.__FileTytpe)
      {
        case frmDumpGridExporter.enFileTytpe.HTML:
          streamWriter.WriteLine("</body>");
          streamWriter.WriteLine("</html>");
          break;
        case frmDumpGridExporter.enFileTytpe.XML:
          streamWriter.WriteLine("</DocumentElement>");
          break;
      }
      if (Index == checked (this.RowCount() - 1))
        e.Result = (object) ("Saved " + Strings.FormatNumber((object) this.RowCount(), 0) + " rows.");
      else
        e.Result = (object) ("Saved " + Strings.FormatNumber((object) this.RowCount(), 0) + " rows, missed " + Conversions.ToString(checked (this.RowCount() - 1 - Index)) + ".");
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Asterisk);
      ProjectData.ClearProjectError();
    }
    finally
    {
      if (this.bwSave.CancellationPending)
        e.Result = (object) "Canceled by user";
      streamWriter?.Close();
    }
  }

  private void bwSave_ProgressChanged(object sender, ProgressChangedEventArgs e)
  {
    if (e.ProgressPercentage < 100)
      this.prbStatus.Value = e.ProgressPercentage;
    this.lblStatus.Text = e.UserState.ToString();
  }

  private void bwSave_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
  {
    this.prbStatus.Value = 0;
    this.prbStatus.Visible = false;
    if (e.Result == null)
      this.lblStatus.Text = "Ready.";
    else
      this.lblStatus.Text = e.Result.ToString();
    this.OK_Button.Enabled = true;
    this.OK_Button.Text = "&Start..";
    this.Cancel_Button.Enabled = true;
    this.GroupBox1.Enabled = true;
    this.GroupBox2.Enabled = true;
    this.GroupBox3.Enabled = true;
    this.rdpType_CheckedChanged((object) null, (EventArgs) null);
    this.__Working = false;
  }

  private int GetColumnIndex(string sName)
  {
    int num = checked (this.__Grid.ColumnCount - 1);
    int index = 1;
    while (index <= num)
    {
      if (sName.Equals(this.__Grid.Columns[index].HeaderText))
        return index;
      checked { ++index; }
    }
    return -1;
  }

  private void OK_Button_Click(object sender, EventArgs e)
  {
    if (this.OK_Button.Text.Equals("&Start.."))
    {
      this.__Columns = new Dictionary<string, int>();
      int num = checked (this.lsColumns.Items.Count - 1);
      int index = 0;
      while (index <= num)
      {
        string str = Conversions.ToString(this.lsColumns.Items[index]);
        if (this.lsColumns.GetItemChecked(index))
          this.__Columns.Add(str, this.GetColumnIndex(str));
        checked { ++index; }
      }
      if (this.__Columns.Count == 0)
      {
        Interaction.Beep();
        this.lblStatus.Text = "Selected the column(s).";
      }
      else
      {
        this.__SplitComma = !this.rdbOpt1.Checked ? this.txtDeli.Text : "\t";
        this.__ReplaceNewLine = this.chkReplaceLines.Checked;
        this.__ReplaceString = this.txtReplaceLine.Text;
        using (SaveFileDialog saveFileDialog = new SaveFileDialog())
        {
          saveFileDialog.Title = "Save as..";
          saveFileDialog.FileName = this.__FileName.Replace("/", "-");
          saveFileDialog.InitialDirectory = this.__LastPath;
          bool flag = true;
          if (this.rdpType_1.Checked)
          {
            this.__FileTytpe = frmDumpGridExporter.enFileTytpe.TXT;
            saveFileDialog.Filter = "Text File|*.txt";
            saveFileDialog.FileName = Path.ChangeExtension(saveFileDialog.FileName, "txt");
          }
          else if (flag == this.rdpType_2.Checked)
          {
            this.__FileTytpe = frmDumpGridExporter.enFileTytpe.HTML;
            saveFileDialog.Filter = "HTML File|*.html";
            saveFileDialog.FileName = Path.ChangeExtension(saveFileDialog.FileName, "html");
          }
          else if (flag == this.rdpType_3.Checked)
          {
            this.__FileTytpe = frmDumpGridExporter.enFileTytpe.XML;
            saveFileDialog.Filter = "XML File|*.xml";
            saveFileDialog.FileName = Path.ChangeExtension(saveFileDialog.FileName, "xml");
          }
          if (saveFileDialog.ShowDialog() != DialogResult.OK)
            return;
          this.__FileName = saveFileDialog.FileName;
          saveFileDialog.InitialDirectory = this.__LastPath;
          this.bwSave.RunWorkerAsync();
          this.OK_Button.Text = "&Cancel..";
          this.prbStatus.Visible = true;
          this.Cancel_Button.Enabled = false;
          this.GroupBox1.Enabled = false;
          this.GroupBox2.Enabled = false;
          this.GroupBox3.Enabled = false;
        }
      }
    }
    else
    {
      this.OK_Button.Enabled = false;
      this.bwSave.CancelAsync();
    }
  }

  private void Cancel_Button_Click(object sender, EventArgs e)
  {
    this.DialogResult = DialogResult.Cancel;
    this.Close();
  }

  private void rdbOpt1_CheckedChanged(object sender, EventArgs e) => this.txtDeli.Enabled = this.rdbOpt2.Checked;

  private void frmDumpGridExporter_FormClosing(object sender, FormClosingEventArgs e)
  {
    try
    {
      Globals.G_XML.SaveSetting(this.Name, "LastPath", this.__LastPath);
      Globals.G_Settings.SaveSettings((Form) this);
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  private void frmDumpGridExporter_Load(object sender, EventArgs e)
  {
    try
    {
      this.OK_Button.Text = "&Start..";
      int num = checked (this.__Grid.ColumnCount - 1);
      int index = 1;
      while (index <= num)
      {
        this.lsColumns.Items.Add((object) this.__Grid.Columns[index].HeaderText);
        this.lsColumns.SetItemChecked(checked (index - 1), true);
        checked { ++index; }
      }
      Globals.G_Settings.LoadSettings((Form) this);
      this.__LastPath = Globals.G_XML.GetSetting(this.Name, "LastPath");
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      int num = (int) MessageBox.Show(ex.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Hand);
      ProjectData.ClearProjectError();
    }
  }

  private void mmnCheck_Click(object sender, EventArgs e)
  {
    int num = checked (this.lsColumns.Items.Count - 1);
    int index = 0;
    while (index <= num)
    {
      bool flag = true;
      if (sender == this.mmnCheck)
        this.lsColumns.SetItemChecked(index, true);
      else if (flag == (sender == this.mmnUnCheck))
        this.lsColumns.SetItemChecked(index, false);
      checked { ++index; }
    }
  }

  private void chkReplaceLines_CheckedChanged(object sender, EventArgs e) => this.txtReplaceLine.Enabled = this.chkReplaceLines.Checked;

  private void mnuColumns_Opening(object sender, CancelEventArgs e)
  {
    e.Cancel = this.__Working;
    if (this.lsColumns.SelectedIndex < 0)
    {
      this.mnuMoveUP.Enabled = false;
      this.mnuMoveDown.Enabled = false;
    }
    else
    {
      this.mnuMoveUP.Enabled = this.lsColumns.SelectedIndex > 0;
      this.mnuMoveDown.Enabled = this.lsColumns.SelectedIndex < checked (this.lsColumns.Items.Count - 1);
    }
  }

  private void mnuMove_Click(object sender, EventArgs e)
  {
    if (sender == this.mnuMoveUP)
    {
      if (this.lsColumns.SelectedIndex <= 0)
        return;
      int index = checked (this.lsColumns.SelectedIndex - 1);
      this.lsColumns.Items.Insert(index, RuntimeHelpers.GetObjectValue(this.lsColumns.SelectedItem));
      this.lsColumns.Items.RemoveAt(this.lsColumns.SelectedIndex);
      this.lsColumns.SelectedIndex = index;
    }
    else
    {
      if (this.lsColumns.SelectedIndex >= checked (this.lsColumns.Items.Count - 1))
        return;
      int index = checked (this.lsColumns.SelectedIndex + 2);
      this.lsColumns.Items.Insert(index, RuntimeHelpers.GetObjectValue(this.lsColumns.SelectedItem));
      this.lsColumns.Items.RemoveAt(this.lsColumns.SelectedIndex);
      this.lsColumns.SelectedIndex = checked (index - 1);
    }
  }

  private void rdpType_CheckedChanged(object sender, EventArgs e) => this.GroupBox3.Enabled = this.rdpType_1.Checked;

  public enum enFileTytpe
  {
    TXT,
    HTML,
    XML,
  }

  private delegate DataGridViewRow GetROW(int Index);

  private delegate int GetCount();
}
